/*! For license information please see chunk.0b77652062422d33181a.js.LICENSE.txt */
"use strict";(self.webpackChunkbody_weight_excercise=self.webpackChunkbody_weight_excercise||[]).push([[320],{64706:(n,t,e)=>{e.d(t,{Z:()=>o,c:()=>a});var r=e(22885);function o(...n){(0,r.OB)().getBool("IS_TEST")||(0,r.OB)().getBool("PROD")||console.warn(...n)}function a(...n){(0,r.OB)().getBool("IS_TEST")||(0,r.OB)().getBool("PROD")||console.log(...n)}},96235:(n,t,e)=>{e.d(t,{W:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({abs_:function(n){const t=(0,a._1)(n,"x","abs");if("complex64"===t.dtype){const n={x:t};return r.BV.runKernel(o.yj2,n)}{const n={x:t};return r.BV.runKernel(o.SYM,n)}}})},17839:(n,t,e)=>{e.d(t,{K:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({acos_:function(n){const t={x:(0,a._1)(n,"x","acos")};return r.BV.runKernel(o.VGw,t)}})},91470:(n,t,e)=>{e.d(t,{_:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({acosh_:function(n){const t={x:(0,a._1)(n,"x","acosh")};return r.BV.runKernel(o.SpW,t)}})},56407:(n,t,e)=>{e.d(t,{I:()=>i});var r=e(23926),o=e(29121),a=e(80747),s=e(43740);const i=(0,e(2668).op)({add_:function(n,t){let e=(0,s._1)(n,"a","add"),i=(0,s._1)(t,"b","add");[e,i]=(0,a.T_)(e,i);const u={a:e,b:i};return r.BV.runKernel(o.mm_,u)}})},13135:(n,t,e)=>{e.d(t,{Q:()=>i});var r=e(23926),o=e(29121),a=e(43740),s=e(20569);const i=(0,e(2668).op)({addN_:function(n){s.hu(Array.isArray(n),(()=>"The argument passed to tf.addN() must be a list of tensors")),s.hu(n.length>=1,(()=>`Must pass at least one tensor to tf.addN(), but got ${n.length}`));const t=n.map(((n,t)=>(0,a._1)(n,`tensors${t}`,"addN"))),e=t[0];t.forEach((n=>{if(n.dtype!==e.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),t.forEach((n=>{if(!s.cO(n.shape,e.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));const i=t;return r.BV.runKernel(o.Xze,i)}})},90781:(n,t,e)=>{e.d(t,{$:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({all_:function(n,t=null,e=!1){const s={x:(0,a._1)(n,"x","all","bool")},i={axis:t,keepDims:e};return r.BV.runKernel(o.oT6,s,i)}})},92998:(n,t,e)=>{e.d(t,{Y:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({any_:function(n,t=null,e=!1){const s={x:(0,a._1)(n,"x","any","bool")},i={axis:t,keepDims:e};return r.BV.runKernel(o.IKK,s,i)}})},40047:(n,t,e)=>{e.d(t,{N:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({argMax_:function(n,t=0){const e={x:(0,a._1)(n,"x","argMax")},s={axis:t};return r.BV.runKernel(o.sJF,e,s)}})},27394:(n,t,e)=>{e.d(t,{v:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({argMin_:function(n,t=0){const e={x:(0,a._1)(n,"x","argMin")},s={axis:t};return r.BV.runKernel(o.aJk,e,s)}})},87199:(n,t,e)=>{function r(n,t,e,r=!0){let o=[];if(r)o=o.concat(t.slice(0)),o.push(n[0]/e),o=o.concat(n.slice(1));else{o=o.concat(n[0]);const e=t.length;for(let r=0;r<e;++r)o=o.concat([n[r+1]/t[r],t[r]]);o=o.concat(n.slice(e+1))}return o}function o(n,t,e=!0){const r=[];if(e){r.push(t);for(let e=t+1;e<n;++e)e<=2*t?(r.push(e),r.push(e-(t+1))):r.push(e)}else{const e=[],o=[];for(let r=1;r<n;++r)r>=2*t+1||r%2==1?o.push(r):e.push(r);r.push(...e),r.push(0),r.push(...o)}return r}function a(n,t,e,r=!0){const o=[];r?o.push(n[0]/e):o.push(n[0]*e);for(let e=1;e<n.length;++e)e<=t.length?r?o.push(t[e-1]*n[e]):o.push(n[e]/t[e-1]):o.push(n[e]);return o}function s(n,t){const e=[0];for(let r=0;r<t;++r)e.push(n[r][0]);return e}function i(n,t,e){const r=n.slice(0,1);for(let o=0;o<e;++o)r.push(n[o+1]-t[o][0]-t[o][1]);return r}e.d(t,{R7:()=>r,TK:()=>a,oP:()=>s,qX:()=>i,xw:()=>o})},72421:(n,t,e)=>{e.d(t,{Z:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({asin_:function(n){const t={x:(0,a._1)(n,"x","asin")};return r.BV.runKernel(o.M2y,t)}})},21891:(n,t,e)=>{e.d(t,{V:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({asinh_:function(n){const t={x:(0,a._1)(n,"x","asinh")};return r.BV.runKernel(o.qw7,t)}})},77037:(n,t,e)=>{e.d(t,{z:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({atan_:function(n){const t={x:(0,a._1)(n,"x","atan")};return r.BV.runKernel(o.jMg,t)}})},29812:(n,t,e)=>{e.d(t,{f:()=>i});var r=e(23926),o=e(29121),a=e(80747),s=e(43740);const i=(0,e(2668).op)({atan2_:function(n,t){let e=(0,s._1)(n,"a","atan2"),i=(0,s._1)(t,"b","atan2");[e,i]=(0,a.T_)(e,i);const u={a:e,b:i};return r.BV.runKernel(o.QCc,u)}})},80369:(n,t,e)=>{e.d(t,{C:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({atanh_:function(n){const t={x:(0,a._1)(n,"x","atanh")};return r.BV.runKernel(o.Oyi,t)}})},15176:(n,t,e)=>{e.d(t,{w:()=>c});var r=e(23926),o=e(29121),a=e(43740),s=e(20569),i=e(62271),u=e(2582),h=e(2668),l=e(4968);const c=(0,h.op)({avgPool_:function(n,t,e,h,c){const p=(0,a._1)(n,"x","avgPool","float32");s.hu(u.jT(e,1),(()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${e} and dilations '1'`));let d=p,f=!1;3===p.rank&&(f=!0,d=(0,l.X)(p,[1,p.shape[0],p.shape[1],p.shape[2]])),s.hu(4===d.rank,(()=>`Error in avgPool: x must be rank 4 but got rank ${d.rank}.`)),u.m("avgPool",h,c);const m={x:d},g={filterSize:t,strides:e,pad:h,dimRoundingMode:c};let b=r.BV.runKernel(o.JhU,m,g);return b=(0,i.p)(b,p.dtype),f?(0,l.X)(b,[b.shape[1],b.shape[2],b.shape[3]]):b}})},61749:(n,t,e)=>{e.d(t,{u:()=>c});var r=e(23926),o=e(29121),a=e(43740),s=e(20569),i=e(62271),u=e(2582),h=e(2668),l=e(4968);const c=(0,h.op)({avgPool3d_:function(n,t,e,h,c,p="NDHWC"){const d=(0,a._1)(n,"x","avgPool3d","float32");let f=d,m=!1;4===d.rank&&(m=!0,f=(0,l.X)(d,[1,d.shape[0],d.shape[1],d.shape[2],d.shape[3]])),s.hu(5===f.rank,(()=>`Error in avgPool3d: x must be rank 5 but got rank ${f.rank}.`)),s.hu("NDHWC"===p,(()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${p}`)),s.hu("number"==typeof e&&e>0||Array.isArray(e)&&e[0]>0&&e[1]>0&&e[2]>0,(()=>`Error in avgPool3d: Stride must be > 0, but got '${e}'`)),(0,u.m)("avgPool3d",h,c);const g={x:f},b={filterSize:t,strides:e,pad:h,dimRoundingMode:c,dataFormat:p};let k=r.BV.runKernel(o._k9,g,b);return k=(0,i.p)(k,f.dtype),m?(0,l.X)(k,[k.shape[1],k.shape[2],k.shape[3],k.shape[4]]):k}})},77992:(n,t,e)=>{e.d(t,{f:()=>l});var r=e(23926),o=e(29121),a=e(43740),s=e(20569),i=e(2582),u=e(2668),h=e(4968);const l=(0,u.op)({avgPool3dGrad_:function(n,t,e,u,l,c){const p=(0,a._1)(n,"dy","avgPool3dGrad"),d=(0,a._1)(t,"input","avgPool3dGrad");let f=p,m=d,g=!1;4===d.rank&&(g=!0,f=(0,h.X)(p,[1,p.shape[0],p.shape[1],p.shape[2],p.shape[3]]),m=(0,h.X)(d,[1,d.shape[0],d.shape[1],d.shape[2],d.shape[3]])),s.hu(5===f.rank,(()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${f.rank}.`)),s.hu(5===m.rank,(()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${m.rank}.`)),(0,i.m)("avgPool3dGrad",l,c);const b={dy:f,input:m},k={filterSize:e,strides:u,pad:l,dimRoundingMode:c},_=r.BV.runKernel(o.IMb,b,k);return g?(0,h.X)(_,[_.shape[1],_.shape[2],_.shape[3],_.shape[4]]):_}})},94162:(n,t,e)=>{e.d(t,{W:()=>h});var r=e(23926),o=e(29121),a=e(43740),s=e(20569),i=e(2668),u=e(4968);const h=(0,i.op)({avgPoolGrad_:function(n,t,e,i,h){const l=(0,a._1)(n,"dy","avgPoolGrad"),c=(0,a._1)(t,"input","avgPoolGrad");s.hu(c.rank===l.rank,(()=>`Rank of input (${c.rank}) does not match rank of dy (${l.rank})`));let p=c,d=l,f=!1;3===c.rank&&(f=!0,p=(0,u.X)(c,[1,c.shape[0],c.shape[1],c.shape[2]]),d=(0,u.X)(l,[1,l.shape[0],l.shape[1],l.shape[2]])),s.hu(4===d.rank,(()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${d.rank}.`)),s.hu(4===p.rank,(()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${p.rank}.`));const m={dy:d,input:p},g={filterSize:e,strides:i,pad:h},b=r.BV.runKernel(o.ROF,m,g);return f?(0,u.X)(b,[b.shape[1],b.shape[2],b.shape[3]]):b}})},83591:(n,t,e)=>{e.d(t,{LJ:()=>l,Q3:()=>h,Vh:()=>a,YB:()=>o,kz:()=>s,lB:()=>u,rv:()=>i,sY:()=>c});var r=e(20569);function o(n,t){for(let e=0;e<n.length;++e)if(n[n.length-e-1]!==t-1-e)return!1;return!0}function a(n,t,e){const r=n.length+t.length,o=[];let a=0,s=0;for(let i=0;i<r;i++)-1===e.indexOf(i)?o.push(n[a++]):o.push(t[s++]);return o}function s(n,t){const e=[],r=n.length;for(let o=0;o<r;o++)-1===t.indexOf(o)&&e.push(n[o]);return[e,t.map((t=>n[t]))]}function i(n,t){return a(n,t.map((n=>1)),t)}function u(n,t,e){r.hu(o(t,e),(()=>`${n} supports only inner-most axes for now. Got axes ${t} and rank-${e} input.`))}function h(n,t){if(o(n,t))return null;const e=[];for(let r=0;r<t;++r)-1===n.indexOf(r)&&e.push(r);return n.forEach((n=>e.push(n))),e}function l(n){return n.map(((n,t)=>[t,n])).sort(((n,t)=>n[1]-t[1])).map((n=>n[0]))}function c(n,t){const e=[];for(let r=t-n;r<t;++r)e.push(r);return e}},7361:(n,t,e)=>{e.d(t,{z:()=>p});var r=e(43740),o=e(56407),a=e(46884),s=e(28687),i=e(24841),u=e(2668),h=e(30625),l=e(22676),c=e(21869);const p=(0,u.op)({basicLSTMCell_:function(n,t,e,u,p,d){const f=(0,r._1)(n,"forgetBias","basicLSTMCell"),m=(0,r._1)(t,"lstmKernel","basicLSTMCell"),g=(0,r._1)(e,"lstmBias","basicLSTMCell"),b=(0,r._1)(u,"data","basicLSTMCell"),k=(0,r._1)(p,"c","basicLSTMCell"),_=(0,r._1)(d,"h","basicLSTMCell"),v=(0,a.z)([b,_],1),x=(0,s.O)(v,m),E=(0,o.I)(x,g),$=E.shape[0],y=E.shape[1]/4,w=[$,y],N=(0,l.t)(E,[0,0],w),B=(0,l.t)(E,[0,y],w),S=(0,l.t)(E,[0,2*y],w),I=(0,l.t)(E,[0,3*y],w),V=(0,o.I)((0,i.d)((0,h.X)(N),(0,c.A)(B)),(0,i.d)(k,(0,h.X)((0,o.I)(f,S))));return[V,(0,i.d)((0,c.A)(V),(0,h.X)(I))]}})},28441:(n,t,e)=>{e.d(t,{E:()=>i});var r=e(23926),o=e(29121),a=e(43740),s=e(20569);const i=(0,e(2668).op)({batchToSpaceND_:function(n,t,e){const i=(0,a._1)(n,"x","batchToSpaceND"),u=t.reduce(((n,t)=>n*t));s.hu(i.rank>=1+t.length,(()=>`input rank is ${i.rank} but should be > than blockShape.length ${t.length}`)),s.hu(e.length===t.length,(()=>`crops.length is ${e.length} but should be equal to blockShape.length  ${t.length}`)),s.hu(i.shape[0]%u==0,(()=>`input tensor batch is ${i.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${u}`));const h={x:i},l={blockShape:t,crops:e};return r.BV.runKernel(o.zws,h,l)}})},27505:(n,t,e)=>{e.d(t,{t:()=>u});var r=e(23926),o=e(29121),a=e(43740),s=e(20569),i=e(4968);const u=(0,e(2668).op)({batchNorm_:function(n,t,e,u,h,l){null==l&&(l=.001);const c=(0,a._1)(n,"x","batchNorm"),p=(0,a._1)(t,"mean","batchNorm"),d=(0,a._1)(e,"variance","batchNorm");let f,m;null!=h&&(f=(0,a._1)(h,"scale","batchNorm")),null!=u&&(m=(0,a._1)(u,"offset","batchNorm")),s.hu(p.rank===d.rank,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),s.hu(null==m||p.rank===m.rank,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),s.hu(null==f||p.rank===f.rank,(()=>"Batch normalization gradient requires mean and scale to have equal ranks."));const g={x:function(n){let t;return t=0===n.rank||1===n.rank?(0,i.X)(n,[1,1,1,n.size]):2===n.rank?(0,i.X)(n,[1,1,n.shape[0],n.shape[1]]):3===n.rank?(0,i.X)(n,[1,n.shape[0],n.shape[1],n.shape[2]]):n,t}(c),scale:f,offset:m,mean:p,variance:d},b={varianceEpsilon:l},k=r.BV.runKernel(o.sHE,g,b);return(0,i.X)(k,c.shape)}})},81837:(n,t,e)=>{e.d(t,{D:()=>s});var r=e(43740),o=e(20569),a=e(27505);const s=(0,e(2668).op)({batchNorm2d_:function(n,t,e,s,i,u){const h=(0,r._1)(n,"x","batchNorm"),l=(0,r._1)(t,"mean","batchNorm"),c=(0,r._1)(e,"variance","batchNorm");let p,d;return null!=i&&(p=(0,r._1)(i,"scale","batchNorm")),null!=s&&(d=(0,r._1)(s,"offset","batchNorm")),o.hu(2===h.rank,(()=>`Error in batchNorm2D: x must be rank 2 but got rank ${h.rank}.`)),o.hu(2===l.rank||1===l.rank,(()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${l.rank}.`)),o.hu(2===c.rank||1===c.rank,(()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${c.rank}.`)),null!=p&&o.hu(2===p.rank||1===p.rank,(()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${p.rank}.`)),null!=d&&o.hu(2===d.rank||1===d.rank,(()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${d.rank}.`)),(0,a.t)(h,l,c,d,p,u)}})},319:(n,t,e)=>{e.d(t,{J:()=>s});var r=e(43740),o=e(20569),a=e(27505);const s=(0,e(2668).op)({batchNorm3d_:function(n,t,e,s,i,u){const h=(0,r._1)(n,"x","batchNorm"),l=(0,r._1)(t,"mean","batchNorm"),c=(0,r._1)(e,"variance","batchNorm");let p,d;return null!=i&&(p=(0,r._1)(i,"scale","batchNorm")),null!=s&&(d=(0,r._1)(s,"offset","batchNorm")),o.hu(3===h.rank,(()=>`Error in batchNorm3D: x must be rank 3 but got rank ${h.rank}.`)),o.hu(3===l.rank||1===l.rank,(()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${l.rank}.`)),o.hu(3===c.rank||1===c.rank,(()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${c.rank}.`)),null!=p&&o.hu(3===p.rank||1===p.rank,(()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${p.rank}.`)),null!=d&&o.hu(3===d.rank||1===d.rank,(()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${d.rank}.`)),(0,a.t)(h,l,c,d,p,u)}})},37969:(n,t,e)=>{e.d(t,{p:()=>s});var r=e(43740),o=e(20569),a=e(27505);const s=(0,e(2668).op)({batchNorm4d_:function(n,t,e,s,i,u){const h=(0,r._1)(n,"x","batchNorm"),l=(0,r._1)(t,"mean","batchNorm"),c=(0,r._1)(e,"variance","batchNorm");let p,d;return null!=i&&(p=(0,r._1)(i,"scale","batchNorm")),null!=s&&(d=(0,r._1)(s,"offset","batchNorm")),o.hu(4===h.rank,(()=>`Error in batchNorm4D: x must be rank 4 but got rank ${h.rank}.`)),o.hu(4===l.rank||1===l.rank,(()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${l.rank}.`)),o.hu(4===c.rank||1===c.rank,(()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${c.rank}.`)),null!=p&&o.hu(4===p.rank||1===p.rank,(()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${p.rank}.`)),null!=d&&o.hu(4===d.rank||1===d.rank,(()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${d.rank}.`)),(0,a.t)(h,l,c,d,p,u)}})},93865:(n,t,e)=>{e.d(t,{y:()=>i});var r=e(23926),o=e(29121),a=e(43740),s=e(20569);const i=(0,e(2668).op)({bincount_:function(n,t,e){const i=(0,a._1)(n,"x","bincount"),u=(0,a._1)(t,"weights","bincount");s.hu("int32"===i.dtype,(()=>`Error in bincount: input dtype must be int32, but got ${i.dtype}`)),s.hu(e>=0,(()=>`size must be non-negative, but got ${e}.`)),s.hu(u.size===i.size||0===u.size,(()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${i.shape}, weights shape: ${u.shape}.`));const h={x:i,weights:u},l={size:e};return r.BV.runKernel(o.zvY,h,l)}})},5123:(n,t,e)=>{e.d(t,{a:()=>h});var r=e(43740),o=e(20569),a=e(24926),s=e(4968),i=e(79590),u=e(66380);const h=async function(n,t,e){const h=(0,r._1)(n,"tensor","boolMask"),l=(0,r._1)(t,"mask","boolMask","bool"),c=null==e?0:e,p=l.rank,d=h.shape;o.hu(p>0,(()=>"mask cannot be scalar")),o.k5(d.slice(c,c+p),l.shape,"mask's shape must match the first K dimensions of tensor's shape,");let f=1;for(let n=c;n<c+p;n++)f*=d[n];const m=d.slice(0,c).concat([f],d.slice(c+p)),g=(0,s.X)(h,m),b=(0,s.X)(l,[-1]),k=await(0,u.i)(b),_=(0,i.L)(k,[1]),v=(0,a.I)(g,_,c);return n!==h&&h.dispose(),t!==l&&l.dispose(),_.dispose(),g.dispose(),b.dispose(),k.dispose(),v}},88194:(n,t,e)=>{e.d(t,{X:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({broadcastArgs_:function(n,t){const e=(0,a._1)(n,"s0","broadcastArgs","int32"),s=(0,a._1)(t,"s1","broadcastArgs","int32");if(1!==e.rank)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${e.rank}`);if(1!==s.rank)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${s.rank}`);const i={s0:e,s1:s};return r.BV.runKernel(o.eEB,i)}})},68247:(n,t,e)=>{e.d(t,{U:()=>l});var r=e(23926),o=e(29121),a=e(43740),s=e(20569),i=e(8723),u=e(2668),h=e(4968);const l=(0,u.op)({broadcastTo_:function(n,t){let e=(0,a._1)(n,"broadcastTo","x");const u=e.shape;if((0,s.Mu)(t),t.length<e.rank)throw new Error(`broadcastTo(): shape.length=${t.length} < input.rank=${e.rank}.`);if(t.length>e.rank){const n=e.shape.slice();for(;n.length<t.length;)n.unshift(1);e=(0,h.X)(e,n)}const l=e.shape,c=Array.from(t);for(let n=t.length-1;n>=0;n--)if(l[n]===t[n])c[n]=1;else if(1!==e.shape[n])throw new Error(`broadcastTo(): [${u}] cannot be broadcast to [${t}].`);if(0===c.map(((n,t)=>n>1?t:-1)).filter((n=>n>=0)).length)return(0,i.d)(e);const p={x:e},d={reps:c};return r.BV.runKernel(o.n9L,p,d)}})},72200:(n,t,e)=>{function r(n,t){const e=n.length,r=[];for(let o=0;o<e;o++){const a=e-1-o,s=n[a]||1;(t[t.length-1-o]||1)>1&&1===s&&r.unshift(a)}return r}function o(n,t){const e=[];for(let r=0;r<t.length;r++){const o=n[n.length-r-1],a=t.length-r-1,s=t[a];(null==o||1===o&&s>1)&&e.unshift(a)}return e}function a(n,t){const e=[],r=Math.max(n.length,t.length);for(let o=0;o<r;o++){let r=n[n.length-o-1];null==r&&(r=1);let a=t[t.length-o-1];if(null==a&&(a=1),1===r)e.unshift(a);else if(1===a)e.unshift(r);else{if(r!==a)throw Error(`Operands could not be broadcast together with shapes ${n} and ${t}.`);e.unshift(r)}}return e}e.r(t),e.d(t,{assertAndGetBroadcastShape:()=>a,getBroadcastDims:()=>r,getReductionAxes:()=>o})},30039:(n,t,e)=>{e.r(t),e.d(t,{fromPixels:()=>g,fromPixelsAsync:()=>f,toPixels:()=>m});var r=e(23926),o=e(22885),a=e(29121),s=e(26151),i=e(4077),u=e(43740),h=e(62271),l=e(2668),c=e(99906);let p;function d(n,t=3){if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==n)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let e=!1,o=!1,i=!1,u=!1,h=!1,l=!1;if(n.data instanceof Uint8Array)e=!0;else if("undefined"!=typeof ImageData&&n instanceof ImageData)o=!0;else if("undefined"!=typeof HTMLVideoElement&&n instanceof HTMLVideoElement)i=!0;else if("undefined"!=typeof HTMLImageElement&&n instanceof HTMLImageElement)u=!0;else if(null!=n.getContext)h=!0;else{if(!("undefined"!=typeof ImageBitmap&&n instanceof ImageBitmap))throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${n.constructor.name}`);l=!0}if(null!=(0,s.pI)(a.eBW,r.BV.backendName)){const e={pixels:n},o={numChannels:t};return r.BV.runKernel(a.eBW,e,o)}const[d,f]=i?[n.videoWidth,n.videoHeight]:[n.width,n.height];let m,g;if(h)m=n.getContext("2d").getImageData(0,0,d,f).data;else if(o||e)m=n.data;else if(u||i||l){if(null==p)if("undefined"==typeof document){if("undefined"==typeof OffscreenCanvas||"undefined"==typeof OffscreenCanvasRenderingContext2D)throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");p=new OffscreenCanvas(1,1).getContext("2d")}else p=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});p.canvas.width=d,p.canvas.height=f,p.drawImage(n,0,0,d,f),m=p.getImageData(0,0,d,f).data}if(4===t)g=new Int32Array(m);else{const n=d*f;g=new Int32Array(n*t);for(let e=0;e<n;e++)for(let n=0;n<t;++n)g[e*t+n]=m[4*e+n]}const b=[f,d,t];return(0,c.w)(g,b,"int32")}async function f(n,t=3){let e=null;if((0,o.OB)().getBool("WRAP_TO_IMAGEBITMAP")&&function(n){return"undefined"!=typeof window&&"undefined"!=typeof ImageBitmap&&window.hasOwnProperty("createImageBitmap")&&!(n instanceof ImageBitmap)&&function(n){return null!=n&&0!==n.width&&0!==n.height}(n)&&!function(n){return null!=n&&n.data instanceof Uint8Array}(n)}(n)){let t;try{t=await createImageBitmap(n,{premultiplyAlpha:"none"})}catch(n){t=null}e=null!=t&&t.width===n.width&&t.height===n.height?t:n}else e=n;return d(e,t)}async function m(n,t){let e=(0,u._1)(n,"img","toPixels");if(!(n instanceof i.es)){const n=e;e=(0,h.p)(n,"int32"),n.dispose()}if(2!==e.rank&&3!==e.rank)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${e.rank}.`);const[r,o]=e.shape.slice(0,2),a=2===e.rank?1:e.shape[2];if(a>4||2===a)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${a}`);if("float32"!==e.dtype&&"int32"!==e.dtype)throw new Error(`Unsupported type for toPixels: ${e.dtype}. Please use float32 or int32 tensors.`);const s=await e.data(),l="float32"===e.dtype?255:1,c=new Uint8ClampedArray(o*r*4);for(let n=0;n<r*o;++n){const t=[0,0,0,255];for(let r=0;r<a;r++){const o=s[n*a+r];if("float32"===e.dtype){if(o<0||o>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${o}.`)}else if("int32"===e.dtype&&(o<0||o>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${o}.`);1===a?(t[0]=o*l,t[1]=o*l,t[2]=o*l):t[r]=o*l}const r=4*n;c[r+0]=Math.round(t[0]),c[r+1]=Math.round(t[1]),c[r+2]=Math.round(t[2]),c[r+3]=Math.round(t[3])}if(null!=t){t.width=o,t.height=r;const n=t.getContext("2d"),e=new ImageData(c,o,r);n.putImageData(e,0,0)}return e!==n&&e.dispose(),c}const g=(0,l.op)({fromPixels_:d})},72657:(n,t,e)=>{e.d(t,{f:()=>a});var r=e(4077),o=e(20569);function a(n,t="float32",e){return t=t||"float32",o.Mu(n),new r.YD(n,t,e)}},62271:(n,t,e)=>{e.d(t,{p:()=>i});var r=e(23926),o=e(29121),a=e(43740),s=e(20569);const i=(0,e(2668).op)({cast_:function(n,t){const e=(0,a._1)(n,"x","cast");if(!s.LP(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if("string"===t&&"string"!==e.dtype||"string"!==t&&"string"===e.dtype)throw new Error("Only strings can be casted to strings");const i={x:e},u={dtype:t};return r.BV.runKernel(o.RFZ,i,u)}})},6825:(n,t,e)=>{e.d(t,{m:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({ceil_:function(n){const t={x:(0,a._1)(n,"x","ceil","float32")};return r.BV.runKernel(o.gJX,t)}})},42279:(n,t,e)=>{e.d(t,{i:()=>u});var r=e(23926),o=e(29121),a=e(43740),s=e(20569),i=e(14006);const u=(0,e(2668).op)({clipByValue_:function(n,t,e){const u=(0,a._1)(n,"x","clipByValue");if(s.hu(t<=e,(()=>`Error in clip: min (${t}) must be less than or equal to max (${e}).`)),t===e)return(0,i.h)(u.shape,t,u.dtype);const h={x:u},l={clipValueMin:t,clipValueMax:e};return r.BV.runKernel(o.xnO,h,l)}})},8723:(n,t,e)=>{e.d(t,{d:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({clone_:function(n){const t={x:(0,a._1)(n,"x","clone","string_or_numeric")};return r.BV.runKernel(o.iJz,t)}})},61661:(n,t,e)=>{e.d(t,{P:()=>i});var r=e(23926),o=e(29121),a=e(43740),s=e(20569);const i=(0,e(2668).op)({complex_:function(n,t){const e=(0,a._1)(n,"real","complex"),i=(0,a._1)(t,"imag","complex");s.k5(e.shape,i.shape,`real and imag shapes, ${e.shape} and ${i.shape}, must match in call to tf.complex().`);const u={real:e,imag:i};return r.BV.runKernel(o.Zz9,u)}})},46884:(n,t,e)=>{e.d(t,{z:()=>u});var r=e(23926),o=e(29121),a=e(43740),s=e(20569),i=e(8723);const u=(0,e(2668).op)({concat_:function(n,t=0){(0,s.hu)(n.length>=1,(()=>"Pass at least one tensor to concat"));const e=(0,a.sI)(n,"tensors","concat","string_or_numeric");if("complex64"===e[0].dtype&&e.forEach((n=>{if("complex64"!==n.dtype)throw new Error(`Cannot concatenate complex64 tensors with a tensor\n          with dtype ${n.dtype}. `)})),1===e.length)return(0,i.d)(e[0]);const u=e,h={axis:t};return r.BV.runKernel(o.Eh3,u,h)}})},72248:(n,t,e)=>{e.d(t,{g:()=>o});var r=e(46884);const o=(0,e(2668).op)({concat1d_:function(n){return(0,r.z)(n,0)}})},99373:(n,t,e)=>{e.d(t,{I:()=>o});var r=e(46884);const o=(0,e(2668).op)({concat2d_:function(n,t){return(0,r.z)(n,t)}})},8093:(n,t,e)=>{e.d(t,{M:()=>o});var r=e(46884);const o=(0,e(2668).op)({concat3d_:function(n,t){return(0,r.z)(n,t)}})},64435:(n,t,e)=>{e.d(t,{Z:()=>o});var r=e(46884);const o=(0,e(2668).op)({concat4d_:function(n,t){return(0,r.z)(n,t)}})},30398:(n,t,e)=>{e.d(t,{N:()=>a,o:()=>o});var r=e(20569);function o(n,t){const e=n[0].length;n.forEach(((n,t)=>{r.hu(n.length===e,(()=>`Error in concat${e}D: rank of tensors[${t}] must be the same as the rank of the rest (${e})`))})),r.hu(t>=0&&t<e,(()=>`Error in concat${e}D: axis must be between 0 and ${e-1}.`));const o=n[0];n.forEach(((n,a)=>{for(let s=0;s<e;s++)r.hu(s===t||n[s]===o[s],(()=>`Error in concat${e}D: Shape of tensors[${a}] (${n}) does not match the shape of the rest (${o}) along the non-concatenated axis ${a}.`))}))}function a(n,t){const e=n[0].slice();for(let r=1;r<n.length;r++)e[t]+=n[r][t];return e}},11355:(n,t,e)=>{e.d(t,{P:()=>h});var r=e(43740),o=e(20569),a=e(64794),s=e(2582),i=e(2668),u=e(4968);const h=(0,i.op)({conv1d_:function(n,t,e,i,h="NWC",l=1,c){const p=(0,r._1)(n,"x","conv1d"),d=(0,r._1)(t,"filter","conv1d");let f=p,m=!1;2===p.rank&&(m=!0,f=(0,u.X)(p,[1,p.shape[0],p.shape[1]])),o.hu(3===f.rank,(()=>`Error in conv1d: input must be rank 3, but got rank ${f.rank}.`)),o.hu(3===d.rank,(()=>`Error in conv1d: filter must be rank 3, but got rank ${d.rank}.`)),s.m("conv1d",i,c),o.hu(f.shape[2]===d.shape[1],(()=>`Error in conv1d: depth of input (${f.shape[2]}) must match input depth for filter ${d.shape[1]}.`)),o.hu(s.jT(e,l),(()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${e} and dilation '${l}'`)),o.hu(s.U3(l),(()=>"Error in conv1D: Dilated rates should be larger than 0.")),o.hu(s.U3(e),(()=>"Error in conv1D: Stride should be larger than 0.")),o.hu("NWC"===h,(()=>`Error in conv1d: got dataFormat of ${h} but only NWC is currently supported.`));const g=(0,u.X)(d,[1,d.shape[0],d.shape[1],d.shape[2]]),b=(0,u.X)(f,[f.shape[0],1,f.shape[1],f.shape[2]]),k=[1,e],_=[1,l],v=(0,a.T)(b,g,k,i,"NHWC",_,c);return m?(0,u.X)(v,[v.shape[2],v.shape[3]]):(0,u.X)(v,[v.shape[0],v.shape[2],v.shape[3]])}})},64794:(n,t,e)=>{e.d(t,{T:()=>l});var r=e(23926),o=e(29121),a=e(43740),s=e(20569),i=e(2582),u=e(2668),h=e(4968);const l=(0,u.op)({conv2d_:function(n,t,e,u,l="NHWC",c=[1,1],p){const d=(0,a._1)(n,"x","conv2d","float32"),f=(0,a._1)(t,"filter","conv2d","float32");let m=d,g=!1;3===d.rank&&(g=!0,m=(0,h.X)(d,[1,d.shape[0],d.shape[1],d.shape[2]])),s.hu(4===m.rank,(()=>`Error in conv2d: input must be rank 4, but got rank ${m.rank}.`)),s.hu(4===f.rank,(()=>`Error in conv2d: filter must be rank 4, but got rank ${f.rank}.`)),i.m("conv2d",u,p);const b="NHWC"===l?m.shape[3]:m.shape[1];s.hu(b===f.shape[2],(()=>`Error in conv2d: depth of input (${b}) must match input depth for filter ${f.shape[2]}.`)),s.hu(i.jT(e,c),(()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${e} and dilations '${c}'`)),s.hu(i.U3(c),(()=>"Error in conv2D: Dilated rates should be larger than 0.")),s.hu(i.U3(e),(()=>"Error in conv2D: Strides should be larger than 0."));const k={x:m,filter:f},_={strides:e,pad:u,dataFormat:l,dilations:c,dimRoundingMode:p},v=r.BV.runKernel(o.mhS,k,_);return g?(0,h.X)(v,[v.shape[1],v.shape[2],v.shape[3]]):v}})},36013:(n,t,e)=>{e.d(t,{p:()=>h});var r=e(23926),o=e(29121),a=e(20569),s=e(2582),i=e(2668),u=e(4968);const h=(0,i.op)({conv2DBackpropFilter_:function(n,t,e,i,h,l="NHWC",c){let p=n;3===n.rank&&(p=(0,u.X)(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let d=t;3===d.rank&&(d=(0,u.X)(t,[1,t.shape[0],t.shape[1],t.shape[2]])),a.hu(4===p.rank,(()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${p.shape}.`)),a.hu(4===d.rank,(()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${d.shape}.`)),a.hu(4===e.length,(()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${e}.`));const f="NHWC"===l?p.shape[3]:p.shape[1],m="NHWC"===l?d.shape[3]:d.shape[1];a.hu(f===e[2],(()=>`Error in conv2dDerFilter: depth of input ${f}) must match input depth in filter (${e[2]}.`)),a.hu(m===e[3],(()=>`Error in conv2dDerFilter: depth of dy (${m}) must match output depth for filter (${e[3]}).`)),s.m("conv2dDerFilter",h,c);const g={x:p,dy:d},b={strides:i,pad:h,dataFormat:l,dimRoundingMode:c,filterShape:e};return r.BV.runKernel(o.wUP,g,b)}})},39832:(n,t,e)=>{e.d(t,{_:()=>h});var r=e(23926),o=e(29121),a=e(20569),s=e(2582),i=e(2668),u=e(4968);const h=(0,i.op)({conv2DBackpropInput_:function(n,t,e,i,h,l="NHWC",c){a.hu(n.length===t.rank,(()=>`Length of inShape (${n.length}) and rank of dy (${t.rank}) must match`));let p=n,d=t,f=!1;3===t.rank&&(f=!0,d=(0,u.X)(t,[1,t.shape[0],t.shape[1],t.shape[2]]),p=[1,n[0],n[1],n[2]]),a.hu(4===p.length,(()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${p.length}.`)),a.hu(4===d.rank,(()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${d.rank}`)),a.hu(4===e.rank,(()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${e.rank}`));const m="NHWC"===l?p[3]:p[1],g="NHWC"===l?d.shape[3]:d.shape[1];a.hu(m===e.shape[2],(()=>`Error in conv2dDerInput: depth of input (${m}) must match input depth for filter ${e.shape[2]}.`)),a.hu(g===e.shape[3],(()=>`Error in conv2dDerInput: depth of output (${g}) must match output depth for filter ${e.shape[3]}.`)),s.m("conv2dDerInput",h,c);const b={dy:d,filter:e},k={strides:i,pad:h,dataFormat:l,dimRoundingMode:c,inputShape:p},_=r.BV.runKernel(o.wm,b,k);return f?(0,u.X)(_,[_.shape[1],_.shape[2],_.shape[3]]):_}})},71405:(n,t,e)=>{e.d(t,{b:()=>a});var r=e(43740),o=e(39832);const a=(0,e(2668).op)({conv2dTranspose_:function(n,t,e,a,s,i){const u=(0,r._1)(n,"x","conv2dTranspose"),h=(0,r._1)(t,"filter","conv2dTranspose");return(0,o._)(e,u,h,a,s,"NHWC",i)}})},70473:(n,t,e)=>{e.d(t,{p:()=>l});var r=e(23926),o=e(29121),a=e(43740),s=e(20569),i=e(2582),u=e(2668),h=e(4968);const l=(0,u.op)({conv3d_:function(n,t,e,u,l="NDHWC",c=[1,1,1]){const p=(0,a._1)(n,"x","conv3d"),d=(0,a._1)(t,"filter","conv3d");let f=p,m=!1;4===p.rank&&(m=!0,f=(0,h.X)(p,[1,p.shape[0],p.shape[1],p.shape[2],p.shape[3]])),s.hu(5===f.rank,(()=>`Error in conv3d: input must be rank 5, but got rank ${f.rank}.`)),s.hu(5===d.rank,(()=>`Error in conv3d: filter must be rank 5, but got rank ${d.rank}.`)),s.hu(f.shape[4]===d.shape[3],(()=>`Error in conv3d: depth of input (${f.shape[4]}) must match input depth for filter ${d.shape[3]}.`)),s.hu((0,i.jT)(e,c),(()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${e} and dilations '${c}'`)),s.hu("NDHWC"===l,(()=>`Error in conv3d: got dataFormat of ${l} but only NDHWC is currently supported.`)),s.hu((0,i.U3)(c),(()=>"Error in conv3D: Dilated rates should be larger than 0.")),s.hu((0,i.U3)(e),(()=>"Error in conv3D: Strides should be larger than 0."));const g={x:f,filter:d},b={strides:e,pad:u,dataFormat:l,dilations:c},k=r.BV.runKernel(o.x12,g,b);return m?(0,h.X)(k,[k.shape[1],k.shape[2],k.shape[3],k.shape[4]]):k}})},3365:(n,t,e)=>{e.d(t,{s:()=>u});var r=e(23926),o=e(29121),a=e(20569),s=e(2668),i=e(4968);const u=(0,s.op)({conv3DBackpropFilter_:function(n,t,e,s,u){let h=n;4===n.rank&&(h=(0,i.X)(n,[1,n.shape[0],n.shape[1],n.shape[2],n.shape[3]]));let l=t;4===l.rank&&(l=(0,i.X)(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),a.hu(5===h.rank,(()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${h.shape}.`)),a.hu(5===l.rank,(()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${l.shape}.`)),a.hu(5===e.length,(()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${e}.`)),a.hu(h.shape[4]===e[3],(()=>`Error in conv3dDerFilter: depth of input ${h.shape[4]}) must match input depth in filter (${e[3]}.`)),a.hu(l.shape[4]===e[4],(()=>`Error in conv3dDerFilter: depth of dy (${l.shape[4]}) must match output depth for filter (${e[4]}).`));const c={x:h,dy:l},p={strides:s,pad:u,filterShape:e};return r.BV.runKernel(o.o2y,c,p)}})},97594:(n,t,e)=>{e.d(t,{_:()=>u});var r=e(23926),o=e(29121),a=e(20569),s=e(2668),i=e(4968);const u=(0,s.op)({conv3DBackpropInput_:function(n,t,e,s,u){a.hu(n.length===t.rank,(()=>`Length of inShape (${n.length}) and rank of dy (${t.rank}) must match`));let h=n,l=t,c=!1;4===t.rank&&(c=!0,l=(0,i.X)(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),h=[1,n[0],n[1],n[2],n[3]]);const p=h[4],d=l.shape[4];a.hu(5===h.length,(()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${h.length}.`)),a.hu(5===l.rank,(()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${l.rank}`)),a.hu(5===e.rank,(()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${e.rank}`)),a.hu(p===e.shape[3],(()=>`Error in conv3dDerInput: depth of input (${p}) must match input depth for filter ${e.shape[3]}.`)),a.hu(d===e.shape[4],(()=>`Error in conv3dDerInput: depth of output (${d}) must match output depth for filter ${e.shape[4]}.`));const f={dy:l,filter:e},m={pad:u,strides:s,inputShape:h},g=r.BV.runKernel(o.ik2,f,m);return c?(0,i.X)(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}})},11160:(n,t,e)=>{e.d(t,{$:()=>a});var r=e(43740),o=e(97594);const a=(0,e(2668).op)({conv3dTranspose_:function(n,t,e,a,s){const i=(0,r._1)(n,"x","conv3dTranspose"),u=(0,r._1)(t,"filter","conv3dTranspose");return(0,o._)(e,i,u,a,s)}})},2582:(n,t,e)=>{e.d(t,{I0:()=>f,Ix:()=>i,Rf:()=>o,U3:()=>g,Xw:()=>a,aO:()=>h,jT:()=>m,jw:()=>u,m:()=>k,pl:()=>s,sl:()=>b});var r=e(20569);function o(n,t,e,r,o="NHWC",a){return i(n,[...t,n[3]],e,a,r,null,null,b(o))}function a(n,t,e,r,o,a,s="channelsLast"){const[u,h]=l(t);let c;if("channelsLast"===s)c=[u,h,n[3],n[3]];else{if("channelsFirst"!==s)throw new Error(`Unknown dataFormat ${s}`);c=[u,h,n[1],n[1]]}return i(n,c,e,r,o,a,!1,s)}function s(n,t,e,r,o,a,s="NDHWC"){const[i,h,l]=c(t);let p,d;if("NDHWC"===s)d="channelsLast",p=[i,h,l,n[4],n[4]];else{if("NCDHW"!==s)throw new Error(`Unknown dataFormat ${s}`);d="channelsFirst",p=[i,h,l,n[1],n[1]]}return u(n,p,e,r,o,!1,d,a)}function i(n,t,e,r,o,a,s=!1,i="channelsLast"){let[u,c,f,m]=[-1,-1,-1,-1];if("channelsLast"===i)[u,c,f,m]=n;else{if("channelsFirst"!==i)throw new Error(`Unknown dataFormat ${i}`);[u,m,c,f]=n}const[g,b,,k]=t,[_,v]=l(e),[x,E]=l(r),$=p(g,x),y=p(b,E),{padInfo:w,outHeight:N,outWidth:B}=function(n,t,e,r,o,a,s,i,u){let l,c,p;if("number"==typeof n){l={top:n,bottom:n,left:n,right:n,type:0===n?"VALID":"NUMBER"};const o=function(n,t,e,r,o){null==r&&(r=h(n,t,e));const a=n[1];return[d((n[0]-t+2*r)/e+1,o),d((a-t+2*r)/e+1,o)]}([t,e],a,r,n,i);c=o[0],p=o[1]}else if("same"===n){c=Math.ceil(t/r),p=Math.ceil(e/o);const n=Math.max(0,(c-1)*r+a-t),i=Math.max(0,(p-1)*o+s-e),u=Math.floor(n/2),h=n-u,d=Math.floor(i/2);l={top:u,bottom:h,left:d,right:i-d,type:"SAME"}}else if("valid"===n)l={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((t-a+1)/r),p=Math.ceil((e-s+1)/o);else{if("object"!=typeof n)throw Error(`Unknown padding parameter: ${n}`);{const h="channelsLast"===u?n[1][0]:n[2][0],f="channelsLast"===u?n[1][1]:n[2][1],m="channelsLast"===u?n[2][0]:n[3][0],g="channelsLast"===u?n[2][1]:n[3][1];l={top:h,bottom:f,left:m,right:g,type:0===h&&0===f&&0===m&&0===g?"VALID":"EXPLICIT"},c=d((t-a+h+f)/r+1,i),p=d((e-s+m+g)/o+1,i)}}return{padInfo:l,outHeight:c,outWidth:p}}(o,c,f,_,v,$,y,a,i),S=s?k*m:k;let I;return"channelsFirst"===i?I=[u,S,N,B]:"channelsLast"===i&&(I=[u,N,B,S]),{batchSize:u,dataFormat:i,inHeight:c,inWidth:f,inChannels:m,outHeight:N,outWidth:B,outChannels:S,padInfo:w,strideHeight:_,strideWidth:v,filterHeight:g,filterWidth:b,effectiveFilterHeight:$,effectiveFilterWidth:y,dilationHeight:x,dilationWidth:E,inShape:n,outShape:I,filterShape:t}}function u(n,t,e,r,o,a=!1,s="channelsLast",i){let[u,l,f,m,g]=[-1,-1,-1,-1,-1];if("channelsLast"===s)[u,l,f,m,g]=n;else{if("channelsFirst"!==s)throw new Error(`Unknown dataFormat ${s}`);[u,g,l,f,m]=n}const[b,k,_,,v]=t,[x,E,$]=c(e),[y,w,N]=c(r),B=p(b,y),S=p(k,w),I=p(_,N),{padInfo:V,outDepth:D,outHeight:T,outWidth:C}=function(n,t,e,r,o,a,s,i,u,l,c){let p,f,m,g;if("valid"===n&&(n=0),"number"==typeof n){p={top:n,bottom:n,left:n,right:n,front:n,back:n,type:0===n?"VALID":"NUMBER"};const b=function(n,t,e,r,o,a){null==o&&(o=h(n,t[0],r[0]));const s=[0,0,0,1];for(let e=0;e<3;e++)n[e]+2*o>=t[e]&&(s[e]=d((n[e]-t[e]+2*o)/r[e]+1,a));return s}([t,e,r,1],[i,u,l],0,[o,a,s],n,c);f=b[0],m=b[1],g=b[2]}else{if("same"!==n)throw Error(`Unknown padding parameter: ${n}`);{f=Math.ceil(t/o),m=Math.ceil(e/a),g=Math.ceil(r/s);const n=(f-1)*o+i-t,h=(m-1)*a+u-e,c=(g-1)*s+l-r,d=Math.floor(n/2),b=n-d,k=Math.floor(h/2),_=h-k,v=Math.floor(c/2);p={top:k,bottom:_,left:v,right:c-v,front:d,back:b,type:"SAME"}}}return{padInfo:p,outDepth:f,outHeight:m,outWidth:g}}(o,l,f,m,x,E,$,B,S,I,i),M=a?v*g:v;let K;return"channelsFirst"===s?K=[u,M,D,T,C]:"channelsLast"===s&&(K=[u,D,T,C,M]),{batchSize:u,dataFormat:s,inDepth:l,inHeight:f,inWidth:m,inChannels:g,outDepth:D,outHeight:T,outWidth:C,outChannels:M,padInfo:V,strideDepth:x,strideHeight:E,strideWidth:$,filterDepth:b,filterHeight:k,filterWidth:_,effectiveFilterDepth:B,effectiveFilterHeight:S,effectiveFilterWidth:I,dilationDepth:y,dilationHeight:w,dilationWidth:N,inShape:n,outShape:K,filterShape:t}}function h(n,t,e,r=1){const o=p(t,r);return Math.floor((n[0]*(e-1)-e+o)/2)}function l(n){return"number"==typeof n?[n,n,n]:2===n.length?[n[0],n[1],1]:n}function c(n){return"number"==typeof n?[n,n,n]:n}function p(n,t){return t<=1?n:n+(n-1)*(t-1)}function d(n,t){if(!t)return Math.trunc(n);switch(t){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error(`Unknown roundingMode ${t}`)}}function f(n){const[t,e,r]=l(n);return 1===t&&1===e&&1===r}function m(n,t){return f(n)||f(t)}function g(n){return l(n).every((n=>n>0))}function b(n){if("NHWC"===n)return"channelsLast";if("NCHW"===n)return"channelsFirst";throw new Error(`Unknown dataFormat ${n}`)}function k(n,t,e){if(null!=e){if("string"==typeof t)throw Error(`Error in ${n}: pad must be an integer when using dimRoundingMode ${e} but got pad ${t}.`);if("number"==typeof t)r.hu(r.GN(t),(()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${e} but got pad ${t}.`));else{if("object"!=typeof t)throw Error(`Error in ${n}: Unknown padding parameter: ${t}`);t.forEach((t=>{t.forEach((t=>{r.hu(r.GN(t),(()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${e} but got pad ${t}.`))}))}))}}}},70173:(n,t,e)=>{e.d(t,{m:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({cos_:function(n){const t={x:(0,a._1)(n,"x","cos","float32")};return r.BV.runKernel(o.mc4,t)}})},2699:(n,t,e)=>{e.d(t,{f:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({cosh_:function(n){const t={x:(0,a._1)(n,"x","cosh","float32")};return r.BV.runKernel(o.TR1,t)}})},9640:(n,t,e)=>{e.d(t,{$:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({cumprod_:function(n,t=0,e=!1,s=!1){const i={x:(0,a._1)(n,"x","cumprod")},u={axis:t,exclusive:e,reverse:s};return r.BV.runKernel(o.Byc,i,u)}})},37405:(n,t,e)=>{e.d(t,{z:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({cumsum_:function(n,t=0,e=!1,s=!1){const i={x:(0,a._1)(n,"x","cumsum")},u={axis:t,exclusive:e,reverse:s};return r.BV.runKernel(o.iHb,i,u)}})},75746:(n,t,e)=>{e.d(t,{p:()=>i});var r=e(23926),o=e(29121),a=e(43740),s=e(20569);const i=(0,e(2668).op)({denseBincount_:function(n,t,e,i=!1){const u=(0,a._1)(n,"x","denseBincount"),h=(0,a._1)(t,"weights","denseBincount");s.hu("int32"===u.dtype,(()=>`Error in denseBincount: input dtype must be int32, but got ${u.dtype}`)),s.hu(u.rank<=2,(()=>`Error in denseBincount: input must be at most rank 2, but got rank ${u.rank}.`)),s.hu(e>=0,(()=>`size must be non-negative, but got ${e}.`)),s.hu(h.size===u.size||0===h.size,(()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${u.shape}, weights shape: ${h.shape}.`));const l={x:u,weights:h},c={size:e,binaryOutput:i};return r.BV.runKernel(o.QRR,l,c)}})},89112:(n,t,e)=>{e.d(t,{n:()=>i});var r=e(23926),o=e(29121),a=e(43740),s=e(20569);const i=(0,e(2668).op)({depthToSpace_:function(n,t,e="NHWC"){const i=(0,a._1)(n,"x","depthToSpace","float32"),u="NHWC"===e?i.shape[1]:i.shape[2],h="NHWC"===e?i.shape[2]:i.shape[3],l="NHWC"===e?i.shape[3]:i.shape[1];s.hu(t>1,(()=>`blockSize should be > 1 for depthToSpace, but was: ${t}`)),s.hu(u*t>=0,(()=>`Negative dimension size caused by overflow when multiplying\n    ${u} and ${t}  for depthToSpace with input shape\n    ${i.shape}`)),s.hu(h*t>=0,(()=>`Negative dimension size caused by overflow when multiplying\n    ${h} and ${t} for depthToSpace with input shape\n        ${i.shape}`)),s.hu(l%(t*t)==0,(()=>`Dimension size must be evenly divisible by ${t*t} but is ${l} for depthToSpace with input shape ${i.shape}`));const c={x:i},p={blockSize:t,dataFormat:e};return r.BV.runKernel(o.T0n,c,p)}})},64718:(n,t,e)=>{e.d(t,{B:()=>l});var r=e(23926),o=e(29121),a=e(43740),s=e(20569),i=e(2582),u=e(2668),h=e(4968);const l=(0,u.op)({depthwiseConv2d_:function(n,t,e,u,l="NHWC",c=[1,1],p){const d=(0,a._1)(n,"x","depthwiseConv2d","float32"),f=(0,a._1)(t,"filter","depthwiseConv2d","float32");let m=d,g=!1;3===d.rank&&(g=!0,m=(0,h.X)(d,[1,d.shape[0],d.shape[1],d.shape[2]])),s.hu(4===m.rank,(()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${m.rank}.`)),s.hu(4===f.rank,(()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${f.rank}.`));const b="NHWC"===l?m.shape[3]:m.shape[1];s.hu(b===f.shape[2],(()=>`Error in depthwiseConv2d: number of input channels (${b}) must match the inChannels dimension in filter ${f.shape[2]}.`)),i.m("depthwiseConv2d",u,p);const k={x:m,filter:f},_={strides:e,pad:u,dataFormat:l,dilations:c,dimRoundingMode:p},v=r.BV.runKernel(o.cie,k,_);return g?(0,h.X)(v,[v.shape[1],v.shape[2],v.shape[3]]):v}})},88098:(n,t,e)=>{e.d(t,{z:()=>i});var r=e(23926),o=e(29121),a=e(2668),s=e(4968);const i=(0,a.op)({depthwiseConv2dNativeBackpropFilter_:function(n,t,e,a,i,u=[1,1],h){let l=n;3===n.rank&&(l=(0,s.X)(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let c=t;3===c.rank&&(c=(0,s.X)(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const p={x:l,dy:c},d={strides:a,pad:i,dimRoundingMode:h,dilations:u,filterShape:e};return r.BV.runKernel(o.sL$,p,d)}})},54375:(n,t,e)=>{e.d(t,{v:()=>i});var r=e(23926),o=e(29121),a=e(2668),s=e(4968);const i=(0,a.op)({depthwiseConv2dNativeBackpropInput_:function(n,t,e,a,i,u=[1,1],h){let l=t,c=!1;3===t.rank&&(c=!0,l=(0,s.X)(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const p={dy:l,filter:e},d={strides:a,pad:i,dimRoundingMode:h,dilations:u,inputShape:n},f=r.BV.runKernel(o.y7R,p,d);return c?(0,s.X)(f,[f.shape[1],f.shape[2],f.shape[3]]):f}})},31118:(n,t,e)=>{e.d(t,{K:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({diag_:function(n){const t={x:(0,a._1)(n,"x","diag")};return r.BV.runKernel(o.$w,t)}})},70557:(n,t,e)=>{e.d(t,{W:()=>h});var r=e(23926),o=e(29121),a=e(43740),s=e(20569),i=e(2668),u=e(4968);const h=(0,i.op)({dilation2d_:function(n,t,e,i,h=[1,1],l="NHWC"){const c=(0,a._1)(n,"x","dilation2d"),p=(0,a._1)(t,"filter","dilation2d");s.hu(3===c.rank||4===c.rank,(()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${c.rank}.`)),s.hu(3===p.rank,(()=>`Error in dilation2d: filter must be rank 3, but got rank ${p.rank}.`)),s.hu("NHWC"===l,(()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${l}`));let d=c,f=!1;3===c.rank&&(d=(0,u.X)(c,[1,c.shape[0],c.shape[1],c.shape[2]]),f=!0),s.hu(d.shape[3]===p.shape[2],(()=>`Error in dilation2d:  input and filter must have the same depth: ${d.shape[3]} vs ${p.shape[2]}`));const m={x:d,filter:p},g={strides:e,pad:i,dilations:h},b=r.BV.runKernel(o.p4S,m,g);return f?(0,u.X)(b,[b.shape[1],b.shape[2],b.shape[3]]):b}})},41274:(n,t,e)=>{e.d(t,{h:()=>u});var r=e(23926),o=e(29121),a=e(80747),s=e(43740),i=e(9165);const u=(0,e(2668).op)({div_:function(n,t){let e=(0,s._1)(n,"a","div"),u=(0,s._1)(t,"b","div");if([e,u]=(0,a.T_)(e,u),"int32"===e.dtype&&"int32"===u.dtype)return(0,i.q)(e,u);const h={a:e,b:u};return r.BV.runKernel(o.oHH,h,{})}})},49322:(n,t,e)=>{e.d(t,{N:()=>l});var r=e(80747),o=e(43740),a=e(41274),s=e(26477),i=e(2668),u=e(95912),h=e(6577);const l=(0,i.op)({divNoNan_:function(n,t){let e=(0,o._1)(n,"a","div"),i=(0,o._1)(t,"b","div");[e,i]=(0,r.T_)(e,i);const l=(0,a.h)(e,i),c=(0,h.P)(l),p=(0,s.D)(i,c);return(0,u.a)(p,c,l)}})},30548:(n,t,e)=>{e.d(t,{A:()=>u});var r=e(43740),o=e(20569),a=e(28687),s=e(2668),i=e(4968);const u=(0,s.op)({dot_:function(n,t){const e=(0,r._1)(n,"t1","dot"),s=(0,r._1)(t,"t2","dot");o.hu(!(1!==e.rank&&2!==e.rank||1!==s.rank&&2!==s.rank),(()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${e.rank} and ${s.rank}.`));const u=1===e.rank?e.size:e.shape[1],h=1===s.rank?s.size:s.shape[0];if(o.hu(u===h,(()=>`Error in dot: inner dimensions of inputs must match, but got ${u} and ${h}.`)),1===e.rank&&1===s.rank){const n=(0,i.X)(e,[1,-1]),t=(0,i.X)(s,[-1,1]),r=(0,a.O)(n,t);return(0,i.X)(r,[])}if(1===e.rank&&2===s.rank){const n=(0,i.X)(e,[1,-1]),t=(0,i.X)(s,[s.shape[0],s.shape[1]]),r=(0,a.O)(n,t);return(0,i.X)(r,[r.size])}if(2===e.rank&&1===s.rank){const n=(0,i.X)(s,[-1,1]),t=(0,a.O)(e,n);return(0,i.X)(t,[t.size])}{const n=(0,i.X)(s,[s.shape[0],s.shape[1]]);return(0,a.O)(e,n)}}})},72223:(n,t,e)=>{e.d(t,{r:()=>p});var r=e(4077),o=e(43740),a=e(20569),s=e(56407),i=e(41274),u=e(26943),h=e(24841),l=e(2668),c=e(75002);const p=(0,l.op)({dropout_:function(n,t,e,l){const p=(0,o._1)(n,"x","dropout");if(a.hu("float32"===p.dtype,(()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${p.dtype} tensor instead.`)),a.hu(t>=0&&t<1,(()=>`rate must be a float in the range [0, 1), but got ${t}.`)),0===t)return n instanceof r.es?p.clone():p;const d=function(n,t){if(null==t)return n.shape.slice();if(a.cO(n.shape,t))return t;if(n.shape.length===t.length){const e=[];for(let r=0;r<n.shape.length;r++)null==t[r]&&null!=n.shape[r]?e.push(n.shape[r]):e.push(t[r]);return e}return t}(p,e),f=1-t,m=(0,i.h)((0,u.G)((0,s.I)((0,c.L)(d,0,1,"float32",l),f)),f);return(0,h.d)(p,m)}})},94653:(n,t,e)=>{e.d(t,{W:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({einsum_:function(n,...t){const e=t.map(((n,t)=>(0,a._1)(n,`tensors${t}`,"einsum"))),s={equation:n};return r.BV.runKernel(o.$g6,e,s)}})},83233:(n,t,e)=>{e.d(t,{p:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({elu_:function(n){const t={x:(0,a._1)(n,"x","elu","float32")};return r.BV.runKernel(o.SX0,t)}})},26477:(n,t,e)=>{e.d(t,{D:()=>u});var r=e(23926),o=e(29121),a=e(80747),s=e(43740),i=e(72200);const u=(0,e(2668).op)({equal_:function(n,t){let e=(0,s._1)(n,"a","equal","string_or_numeric"),u=(0,s._1)(t,"b","equal","string_or_numeric");[e,u]=(0,a.T_)(e,u),(0,i.assertAndGetBroadcastShape)(e.shape,u.shape);const h={a:e,b:u};return r.BV.runKernel(o.hdR,h)}})},34650:(n,t,e)=>{e.d(t,{q:()=>u});var r=e(23926),o=e(29121),a=e(43740),s=e(20569),i=e(62271);const u=(0,e(2668).op)({erf_:function(n){let t=(0,a._1)(n,"x","erf");s.hu("int32"===t.dtype||"float32"===t.dtype,(()=>"Input dtype must be `int32` or `float32`.")),"int32"===t.dtype&&(t=(0,i.p)(t,"float32"));const e={x:t};return r.BV.runKernel(o.Omj,e)}})},52176:(n,t,e)=>{e.d(t,{Aj:()=>o,IA:()=>r,Kh:()=>s,Qy:()=>i,eh:()=>u,py:()=>a});const r=.3275911,o=.254829592,a=-.284496736,s=1.421413741,i=-1.453152027,u=1.061405429},31954:(n,t,e)=>{e.d(t,{d:()=>o});var r=e(3561);const o=(0,e(2668).op)({euclideanNorm_:function(n,t=null,e=!1){return(0,r.K)(n,"euclidean",t,e)}})},44842:(n,t,e)=>{e.d(t,{Q:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({exp_:function(n){const t={x:(0,a._1)(n,"x","exp")};return r.BV.runKernel(o.NEP,t)}})},81300:(n,t,e)=>{e.d(t,{d:()=>i});var r=e(23926),o=e(29121),a=e(43740),s=e(20569);const i=(0,e(2668).op)({expandDims_:function(n,t=0){const e=(0,a._1)(n,"x","expandDims","string_or_numeric");s.hu(t<=e.rank,(()=>"Axis must be <= rank of the tensor"));const i={input:e},u={dim:t};return r.BV.runKernel(o.YFo,i,u)}})},53426:(n,t,e)=>{e.d(t,{t:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({expm1_:function(n){const t={x:(0,a._1)(n,"x","expm1")};return r.BV.runKernel(o.Y0y,t)}})},66557:(n,t,e)=>{e.d(t,{i:()=>u});var r=e(72657),o=e(81300),a=e(2668),s=e(4968),i=e(47501);const u=(0,a.op)({eye_:function(n,t,e,a="float32"){null==t&&(t=n);const u=(0,r.f)([n,t],a),h=n<=t?n:t;for(let n=0;n<h;++n)u.set(1,n,n);const l=(0,s.X)(u.toTensor(),[n,t]);if(null==e)return l;if(1===e.length)return(0,i.G)((0,o.d)(l,0),[e[0],1,1]);if(2===e.length)return(0,i.G)((0,o.d)((0,o.d)(l,0),0),[e[0],e[1],1,1]);if(3===e.length)return(0,i.G)((0,o.d)((0,o.d)((0,o.d)(l,0),0),0),[e[0],e[1],e[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${e.length}D.`)}})},14006:(n,t,e)=>{e.d(t,{h:()=>s});var r=e(23926),o=e(29121),a=e(20569);function s(n,t,e){(0,a.Mu)(n);const s={shape:n,value:t,dtype:e};return r.BV.runKernel(o.deh,{},s)}},26943:(n,t,e)=>{e.d(t,{G:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({floor_:function(n){const t={x:(0,a._1)(n,"x","floor","float32")};return r.BV.runKernel(o.OR,t)}})},9165:(n,t,e)=>{e.d(t,{q:()=>i});var r=e(23926),o=e(29121),a=e(80747),s=e(43740);const i=(0,e(2668).op)({floorDiv_:function(n,t){let e=(0,s._1)(n,"a","floorDiv"),i=(0,s._1)(t,"b","floorDiv");[e,i]=(0,a.T_)(e,i);const u={a:e,b:i};return r.BV.runKernel(o.jeX,u)}})},84624:(n,t,e)=>{e.r(t),e.d(t,{conv2d:()=>k,depthwiseConv2d:()=>E,matMul:()=>y});var r=e(23926),o=e(30633),a=e(29121),s=e(80747),i=e(43740),u=e(20569),h=e(56407),l=e(72200),c=e(64794),p=e(36013),d=e(39832),f=e(2582),m=e(19323),g=e(2668),b=e(4968);const k=(0,g.op)({fusedConv2d_:function({x:n,filter:t,strides:e,pad:g,dataFormat:k="NHWC",dilations:_=[1,1],dimRoundingMode:v,bias:x,activation:E="linear",preluActivationWeights:$,leakyreluAlpha:y}){if(E=E||"linear",!1===(0,m.uy)(r.BV.state.gradientDepth,E)){u.hu("NHWC"===k,(()=>`Error in fused conv2d: got dataFormat of ${k} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`));let r=(0,c.T)(n,t,e,g,k,_,v);return null!=x&&(r=(0,h.I)(r,x)),(0,m.QH)(r,E,$,y)}const w=(0,i._1)(n,"x","conv2d","float32"),N=(0,i._1)(t,"filter","conv2d","float32");let B=w,S=!1;3===w.rank&&(S=!0,B=(0,b.X)(w,[1,w.shape[0],w.shape[1],w.shape[2]])),u.hu(4===B.rank,(()=>`Error in fused conv2d: input must be rank 4, but got rank ${B.rank}.`)),u.hu(4===N.rank,(()=>`Error in fused conv2d: filter must be rank 4, but got rank ${N.rank}.`)),f.m("fused conv2d",g,v);const I="NHWC"===k?B.shape[3]:B.shape[1];u.hu(N.shape[2]===I,(()=>`Error in conv2d: depth of input (${I}) must match input depth for filter ${N.shape[2]}.`)),u.hu(f.jT(e,_),(()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${e} and dilations '${_}'`));const V=f.Ix(B.shape,N.shape,e,_,g,v);let D,T;if(null!=x&&(D=(0,i._1)(x,"bias","fused conv2d"),[D]=(0,s.T_)(D,w),"NHWC"===k?l.assertAndGetBroadcastShape(V.outShape,D.shape):(u.hu(D.shape.length<=1,(()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${D.shape.length}.`)),u.hu(0===D.shape.length||D.shape[0]===V.outChannels||1===D.shape[0],(()=>`Error in fused conv2d: bias shape (${D.shape}) is not compatible with the number of output channels (${V.outChannels})`)))),null!=$){const n=$.shape;if(u.hu(n.length<=1||3===n.length,(()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${n.length}.`)),1===n.length)u.hu(1===n[0]||n[0]===V.outChannels,(()=>`Error in fused conv2d: PReLU activation weights (${n}) is not compatible with the number of output channels (${V.outChannels}).`));else if(3===n.length)try{l.assertAndGetBroadcastShape(n,V.outShape)}catch(t){const e=`Error in fused conv2d: PReLU activation weights (${n}) is not compatible with the output shape of the conv2d (${V.outShape}).`;throw Error(e)}T=(0,i._1)($,"prelu weights","fused conv2d")}const C=(n,t)=>{u.hu("NHWC"===k,(()=>`Error in gradient of fused conv2D: got dataFormat of ${k} but only NHWC is currently supported.`));const[r,o,a,s]=t,i=(0,m.Fr)(n,a,E);u.hu(f.I0(_),(()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${_}'`));const h=[(0,d._)(o.shape,i,r,e,g),(0,p.p)(o,i,r.shape,e,g)];if(null!=s){const n=(0,m.pf)(s,i);h.push(n)}return h},M={x:B,filter:N,bias:D,preluActivationWeights:T},K={strides:e,pad:g,dataFormat:k,dilations:_,dimRoundingMode:v,activation:E,leakyreluAlpha:y};if(null==x){const n=(0,o.cb)(((n,t,e)=>{let o=r.BV.runKernel(a._V0,M,K);return e([t,n,o]),S&&(o=(0,b.X)(o,[o.shape[1],o.shape[2],o.shape[3]])),{value:o,gradFunc:C}}));return n(B,N)}{const n=(0,o.cb)(((n,t,e,o)=>{let s=r.BV.runKernel(a._V0,M,K);return o([t,n,s,e]),S&&(s=(0,b.X)(s,[s.shape[1],s.shape[2],s.shape[3]])),{value:s,gradFunc:C}}));return n(B,N,D)}}});var _=e(64718),v=e(88098),x=e(54375);const E=(0,g.op)({fusedDepthwiseConv2d_:function({x:n,filter:t,strides:e,pad:c,dataFormat:p="NHWC",dilations:d=[1,1],dimRoundingMode:g,bias:k,activation:E="linear",preluActivationWeights:$,leakyreluAlpha:y}){if(!1===(0,m.uy)(r.BV.state.gradientDepth,E)){let r=(0,_.B)(n,t,e,c,p,d,g);return null!=k&&(r=(0,h.I)(r,k)),(0,m.QH)(r,E,$,y)}const w=(0,i._1)(n,"x","depthwiseConv2d","float32"),N=(0,i._1)(t,"filter","depthwiseConv2d","float32");let B=w,S=!1;3===w.rank&&(S=!0,B=(0,b.X)(w,[1,w.shape[0],w.shape[1],w.shape[2]])),u.hu(4===B.rank,(()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${B.rank}.`)),u.hu(4===N.rank,(()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${N.rank}.`)),u.hu(B.shape[3]===N.shape[2],(()=>`Error in fused depthwiseConv2d: number of input channels (${B.shape[3]}) must match the inChannels dimension in filter ${N.shape[2]}.`)),null==d&&(d=[1,1]),u.hu(f.jT(e,d),(()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${e} and dilations '${d}'`)),f.m("fused depthwiseConv2d",c,g);const I=f.Ix(B.shape,N.shape,e,d,c,g,!0);let V,D;null!=k&&(V=(0,i._1)(k,"bias","fused conv2d"),[V]=(0,s.T_)(V,w),l.assertAndGetBroadcastShape(I.outShape,V.shape)),null!=$&&(D=(0,i._1)($,"prelu weights","fused depthwiseConv2d"));const T=(n,t)=>{u.hu(f.I0(d),(()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${d}'`));const[r,o,a,s]=t,i=(0,m.Fr)(n,a,E),h=(0,x.v)(o.shape,i,r,e,c,d,g),l=(0,v.z)(o,i,r.shape,e,c,d,g);return null!=s?[h,l,(0,m.pf)(V,i)]:[h,l]},C={x:B,filter:N,bias:V,preluActivationWeights:D},M={strides:e,pad:c,dataFormat:p,dilations:d,dimRoundingMode:g,activation:E,leakyreluAlpha:y};if(null==k){const n=(0,o.cb)(((n,t,e)=>{let o=r.BV.runKernel(a.luS,C,M);return e([t,n,o]),S&&(o=(0,b.X)(o,[o.shape[1],o.shape[2],o.shape[3]])),{value:o,gradFunc:T}}));return n(B,N)}{const n=(0,o.cb)(((n,t,e,o)=>{let s=r.BV.runKernel(a.luS,C,M);return o([t,n,s,e]),S&&(s=(0,b.X)(s,[s.shape[1],s.shape[2],s.shape[3]])),{value:s,gradFunc:T}}));return n(B,N,V)}}});var $=e(28687);const y=(0,g.op)({fusedMatMul_:function({a:n,b:t,transposeA:e=!1,transposeB:c=!1,bias:p,activation:d="linear",preluActivationWeights:f,leakyreluAlpha:g=.2}){if(!1===(0,m.uy)(r.BV.state.gradientDepth,d)){let r=(0,$.O)(n,t,e,c);return null!=p&&(r=(0,h.I)(r,p)),(0,m.QH)(r,d,f,g)}let k=(0,i._1)(n,"a","fused matMul"),_=(0,i._1)(t,"b","fused matMul");[k,_]=(0,s.T_)(k,_);const v=e?k.shape[k.rank-2]:k.shape[k.rank-1],x=c?_.shape[_.rank-1]:_.shape[_.rank-2],E=e?k.shape[k.rank-1]:k.shape[k.rank-2],y=c?_.shape[_.rank-2]:_.shape[_.rank-1],w=k.shape.slice(0,-2),N=_.shape.slice(0,-2),B=u.NA(w),S=u.NA(N);u.hu(v===x,(()=>`Error in fused matMul: inner shapes (${v}) and (${x}) of Tensors with shapes ${k.shape} and ${_.shape} and transposeA=${e} and transposeB=${c} must match.`));const I=l.assertAndGetBroadcastShape(k.shape.slice(0,-2),_.shape.slice(0,-2)).concat([E,y]),V=e?(0,b.X)(k,[B,v,E]):(0,b.X)(k,[B,E,v]),D=c?(0,b.X)(_,[S,y,x]):(0,b.X)(_,[S,x,y]);let T,C;null!=p&&(T=(0,i._1)(p,"bias","fused matMul"),[T]=(0,s.T_)(T,k),l.assertAndGetBroadcastShape(I,T.shape)),null!=f&&(C=(0,i._1)(f,"prelu weights","fused matMul"));const M=(n,t)=>{const[r,o,a,s]=t,i=(0,m.Fr)((0,b.X)(n,a.shape),a,d);let u,h;return e||c?!e&&c?(u=(0,$.O)(i,o,!1,!1),h=(0,$.O)(i,r,!0,!1)):e&&!c?(u=(0,$.O)(o,i,!1,!0),h=(0,$.O)(r,i,!1,!1)):(u=(0,$.O)(o,i,!0,!0),h=(0,$.O)(i,r,!0,!0)):(u=(0,$.O)(i,o,!1,!0),h=(0,$.O)(r,i,!0,!1)),null!=p?[u,h,(0,m.pf)(s,i)]:[u,h]},K={a:V,b:D,bias:T,preluActivationWeights:C},W={transposeA:e,transposeB:c,activation:d,leakyreluAlpha:g};if(null==p){const n=(0,o.cb)(((n,t,e)=>{const o=r.BV.runKernel(a.usg,K,W);return e([n,t,o]),{value:(0,b.X)(o,I),gradFunc:M}}));return n(V,D)}{const n=(0,o.cb)(((n,t,e,o)=>{const s=r.BV.runKernel(a.usg,K,W);return o([n,t,s,e]),{value:(0,b.X)(s,I),gradFunc:M}}));return n(V,D,T)}}})},19323:(n,t,e)=>{e.d(t,{Fr:()=>f,QH:()=>g,pf:()=>m,uy:()=>b});var r=e(72200),o=e(83233),a=e(99133),s=e(24841),i=e(98151),u=e(7409),h=e(83582),l=e(4968),c=e(30625),p=e(71901),d=e(15475);function f(n,t,e){if(null==e||"linear"===e)return n;if("relu"===e)return(0,s.d)(n,(0,p.N)(t));throw new Error(`Cannot compute gradient for fused activation ${e}.`)}function m(n,t){let e=t;const o=r.getReductionAxes(n.shape,t.shape);return o.length>0&&(e=(0,d.S)(e,o)),(0,l.X)(e,n.shape)}function g(n,t,e,r){if("linear"===t)return n;if("relu"===t)return(0,u.U)(n);if("elu"===t)return(0,o.p)(n);if("relu6"===t)return(0,h.b)(n);if("prelu"===t)return(0,i.A)(n,e);if("leakyrelu"===t)return(0,a.h)(n,r);if("sigmoid"===t)return(0,c.X)(n);throw new Error(`Unknown fused activation ${t}.`)}const b=(n,t)=>!(n>0)||"linear"===t},24926:(n,t,e)=>{e.d(t,{I:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({gather_:function(n,t,e=0,s=0){const i={x:(0,a._1)(n,"x","gather"),indices:(0,a._1)(t,"indices","gather","int32")},u={axis:e,batchDims:s};return r.BV.runKernel(o.qi_,i,u)}})},87494:(n,t,e)=>{e.d(t,{d:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({gatherND_:function(n,t){const e=(0,a._1)(t,"indices","gatherND","int32"),s={params:(0,a._1)(n,"x","gatherND","string_or_numeric"),indices:e};return r.BV.runKernel(o.q1x,s)}})},37410:(n,t,e)=>{e.d(t,{V:()=>o});var r=e(20569);function o(n,t){const e=n.shape.length,o=t.shape.length;if(e<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${e}.`);if(o<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${o}.`);if("int32"!==t.dtype)throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[o-1]>e)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[o-1]} vs. ${e}`);if(0===(0,r.NA)(n.shape))throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${n.shape}.`);const a=t.shape,s=a[a.length-1];let i=1;for(let n=0;n<a.length-1;++n)i*=a[n];const u=n.shape,h=a.slice();h.pop();let l=1;for(let n=s;n<e;++n)l*=u[n],h.push(u[n]);const c=[...(0,r.e3)(n.shape).map((n=>n/l)),1].slice(0,s);return[h,i,l,c]}},20636:(n,t,e)=>{e.d(t,{p:()=>u});var r=e(23926),o=e(29121),a=e(80747),s=e(43740),i=e(72200);const u=(0,e(2668).op)({greater_:function(n,t){let e=(0,s._1)(n,"a","greater","string_or_numeric"),u=(0,s._1)(t,"b","greater","string_or_numeric");[e,u]=(0,a.T_)(e,u),(0,i.assertAndGetBroadcastShape)(e.shape,u.shape);const h={a:e,b:u};return r.BV.runKernel(o.iZT,h)}})},17630:(n,t,e)=>{e.d(t,{b:()=>u});var r=e(23926),o=e(29121),a=e(80747),s=e(43740),i=e(72200);const u=(0,e(2668).op)({greaterEqual_:function(n,t){let e=(0,s._1)(n,"a","greaterEqual","string_or_numeric"),u=(0,s._1)(t,"b","greaterEqual","string_or_numeric");[e,u]=(0,a.T_)(e,u),(0,i.assertAndGetBroadcastShape)(e.shape,u.shape);const h={a:e,b:u};return r.BV.runKernel(o.Acj,h)}})},64386:(n,t,e)=>{e.d(t,{a:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({imag_:function(n){const t={input:(0,a._1)(n,"input","imag")};return r.BV.runKernel(o.J_u,t)}})},61066:(n,t,e)=>{e.d(t,{B:()=>i});var r=e(23926),o=e(29121),a=e(43740),s=e(20569);const i=(0,e(2668).op)({cropAndResize_:function(n,t,e,i,u="bilinear",h=0){const l=(0,a._1)(n,"image","cropAndResize"),c=(0,a._1)(t,"boxes","cropAndResize","float32"),p=(0,a._1)(e,"boxInd","cropAndResize","int32"),d=c.shape[0];s.hu(4===l.rank,(()=>`Error in cropAndResize: image must be rank 4,but got rank ${l.rank}.`)),s.hu(2===c.rank&&4===c.shape[1],(()=>`Error in cropAndResize: boxes must be have size [${d},4] but had shape ${c.shape}.`)),s.hu(1===p.rank&&p.shape[0]===d,(()=>`Error in cropAndResize: boxInd must be have size [${d}] but had shape ${c.shape}.`)),s.hu(2===i.length,(()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${i.length}.`)),s.hu(i[0]>=1&&i[1]>=1,(()=>`cropSize must be atleast [1,1], but was ${i}`)),s.hu("bilinear"===u||"nearest"===u,(()=>`method must be bilinear or nearest, but was ${u}`));const f={image:l,boxes:c,boxInd:p},m={method:u,extrapolationValue:h,cropSize:i};return r.BV.runKernel(o.VcC,f,m)}})},90824:(n,t,e)=>{e.d(t,{V:()=>i});var r=e(23926),o=e(29121),a=e(43740),s=e(20569);const i=(0,e(2668).op)({flipLeftRight_:function(n){const t=(0,a._1)(n,"image","flipLeftRight","float32");s.hu(4===t.rank,(()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`));const e={image:t};return r.BV.runKernel(o.Uyb,e,{})}})},16114:(n,t,e)=>{e.d(t,{F:()=>i});var r=e(43740),o=e(20569),a=e(2668),s=e(47501);const i=(0,a.op)({grayscaleToRGB_:function(n){const t=(0,r._1)(n,"image","grayscaleToRGB"),e=t.rank-1,a=t.shape[e];o.hu(t.rank>=2,(()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${t.rank}.`)),o.hu(1===a,(()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${a}.`));const i=new Array(t.rank);return i.fill(1,0,e),i[e]=3,(0,s.G)(t,i)}})},99009:(n,t,e)=>{e.d(t,{o:()=>i});var r=e(23926),o=e(29121),a=e(43740),s=e(69869);const i=(0,e(2668).op)({nonMaxSuppression_:function(n,t,e,i=.5,u=Number.NEGATIVE_INFINITY){const h=(0,a._1)(n,"boxes","nonMaxSuppression","float32"),l=(0,a._1)(t,"scores","nonMaxSuppression","float32"),c=(0,s.e)(h,l,e,i,u),p={maxOutputSize:e=c.maxOutputSize,iouThreshold:i=c.iouThreshold,scoreThreshold:u=c.scoreThreshold};return r.BV.runKernel(o.uv1,{boxes:h,scores:l},p)}})},56526:(n,t,e)=>{e.d(t,{V:()=>i});var r=e(83337),o=e(43740),a=e(69869),s=e(46092);const i=async function(n,t,e,i=.5,u=Number.NEGATIVE_INFINITY){const h=(0,o._1)(n,"boxes","nonMaxSuppressionAsync"),l=(0,o._1)(t,"scores","nonMaxSuppressionAsync"),c=(0,a.e)(h,l,e,i,u);e=c.maxOutputSize,i=c.iouThreshold,u=c.scoreThreshold;const p=await Promise.all([h.data(),l.data()]),d=p[0],f=p[1],{selectedIndices:m}=(0,r.GP)(d,f,e,i,u);return h!==n&&h.dispose(),l!==t&&l.dispose(),(0,s.R)(m,"int32")}},63765:(n,t,e)=>{e.d(t,{q:()=>i});var r=e(23926),o=e(29121),a=e(43740),s=e(69869);const i=(0,e(2668).op)({nonMaxSuppressionPadded_:function(n,t,e,i=.5,u=Number.NEGATIVE_INFINITY,h=!1){const l=(0,a._1)(n,"boxes","nonMaxSuppression"),c=(0,a._1)(t,"scores","nonMaxSuppression"),p=(0,s.e)(l,c,e,i,u,null),d={boxes:l,scores:c},f={maxOutputSize:p.maxOutputSize,iouThreshold:p.iouThreshold,scoreThreshold:p.scoreThreshold,padToMaxOutputSize:h},m=r.BV.runKernel(o.cye,d,f);return{selectedIndices:m[0],validOutputs:m[1]}}})},88500:(n,t,e)=>{e.d(t,{N:()=>u});var r=e(83337),o=e(43740),a=e(69869),s=e(99494),i=e(46092);const u=async function(n,t,e,u=.5,h=Number.NEGATIVE_INFINITY,l=!1){const c=(0,o._1)(n,"boxes","nonMaxSuppressionAsync"),p=(0,o._1)(t,"scores","nonMaxSuppressionAsync"),d=(0,a.e)(c,p,e,u,h,null),f=d.maxOutputSize,m=d.iouThreshold,g=d.scoreThreshold,[b,k]=await Promise.all([c.data(),p.data()]),{selectedIndices:_,validOutputs:v}=(0,r.qP)(b,k,f,m,g,l);return c!==n&&c.dispose(),p!==t&&p.dispose(),{selectedIndices:(0,i.R)(_,"int32"),validOutputs:(0,s.i)(v,"int32")}}},91424:(n,t,e)=>{e.d(t,{t:()=>i});var r=e(23926),o=e(29121),a=e(43740),s=e(69869);const i=(0,e(2668).op)({nonMaxSuppressionWithScore_:function(n,t,e,i=.5,u=Number.NEGATIVE_INFINITY,h=0){const l=(0,a._1)(n,"boxes","nonMaxSuppression"),c=(0,a._1)(t,"scores","nonMaxSuppression"),p=(0,s.e)(l,c,e,i,u,h),d={boxes:l,scores:c},f={maxOutputSize:e=p.maxOutputSize,iouThreshold:i=p.iouThreshold,scoreThreshold:u=p.scoreThreshold,softNmsSigma:h=p.softNmsSigma},m=r.BV.runKernel(o.W0H,d,f);return{selectedIndices:m[0],selectedScores:m[1]}}})},18135:(n,t,e)=>{e.d(t,{B:()=>i});var r=e(83337),o=e(43740),a=e(69869),s=e(46092);const i=async function(n,t,e,i=.5,u=Number.NEGATIVE_INFINITY,h=0){const l=(0,o._1)(n,"boxes","nonMaxSuppressionAsync"),c=(0,o._1)(t,"scores","nonMaxSuppressionAsync"),p=(0,a.e)(l,c,e,i,u,h);e=p.maxOutputSize,i=p.iouThreshold,u=p.scoreThreshold,h=p.softNmsSigma;const d=await Promise.all([l.data(),c.data()]),f=d[0],m=d[1],{selectedIndices:g,selectedScores:b}=(0,r.pA)(f,m,e,i,u,h);return l!==n&&l.dispose(),c!==t&&c.dispose(),{selectedIndices:(0,s.R)(g,"int32"),selectedScores:(0,s.R)(b)}}},13305:(n,t,e)=>{e.d(t,{I:()=>h});var r=e(23926),o=e(29121),a=e(43740),s=e(20569),i=e(2668),u=e(4968);const h=(0,i.op)({resizeBilinear_:function(n,t,e=!1,i=!1){const h=(0,a._1)(n,"images","resizeBilinear");s.hu(3===h.rank||4===h.rank,(()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${h.rank}.`)),s.hu(2===t.length,(()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`)),s.hu(!1===i||!1===e,(()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."));let l=h,c=!1;3===h.rank&&(c=!0,l=(0,u.X)(h,[1,h.shape[0],h.shape[1],h.shape[2]]));const[]=t,p={images:l},d={alignCorners:e,halfPixelCenters:i,size:t},f=r.BV.runKernel(o._Yw,p,d);return c?(0,u.X)(f,[f.shape[1],f.shape[2],f.shape[3]]):f}})},95098:(n,t,e)=>{e.d(t,{j:()=>h});var r=e(23926),o=e(29121),a=e(43740),s=e(20569),i=e(2668),u=e(4968);const h=(0,i.op)({resizeNearestNeighbor_:function(n,t,e=!1,i=!1){const h=(0,a._1)(n,"images","resizeNearestNeighbor");s.hu(3===h.rank||4===h.rank,(()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${h.rank}.`)),s.hu(2===t.length,(()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`)),s.hu("float32"===h.dtype||"int32"===h.dtype,(()=>"`images` must have `int32` or `float32` as dtype")),s.hu(!1===i||!1===e,(()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."));let l=h,c=!1;3===h.rank&&(c=!0,l=(0,u.X)(h,[1,h.shape[0],h.shape[1],h.shape[2]]));const[]=t,p={images:l},d={alignCorners:e,halfPixelCenters:i,size:t},f=r.BV.runKernel(o.dpD,p,d);return c?(0,u.X)(f,[f.shape[1],f.shape[2],f.shape[3]]):f}})},26466:(n,t,e)=>{e.d(t,{f:()=>i});var r=e(23926),o=e(29121),a=e(43740),s=e(20569);const i=(0,e(2668).op)({rotateWithOffset_:function(n,t,e=0,i=.5){const u=(0,a._1)(n,"image","rotateWithOffset","float32");s.hu(4===u.rank,(()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${u.rank}.`));const h={image:u},l={radians:t,fillValue:e,center:i};return r.BV.runKernel(o.b9H,h,l)}})},92381:(n,t,e)=>{e.d(t,{L:()=>$});var r=e(46092),o=e(2668),a=e(62271),s=e(28644),i=e(93865),u=e(50624),h=e(20636),l=e(15475),c=e(56407),p=e(24841),d=e(41274),f=e(70827),m=e(97809),g=e(95912),b=e(14006),k=e(22676),_=e(47245),v=e(10701),x=e(20569),E=e(43740);const $=(0,o.op)({threshold_:function(n,t="binary",e=!1,o=.5){const $=(0,E._1)(n,"image","threshold"),y=$.shape[0]*$.shape[1];let w,N,B,S,I=(0,p.d)((0,r.R)([o]),255);if(x.hu(3===$.rank,(()=>`Error in threshold: image must be rank 3,but got rank ${$.rank}.`)),x.hu(3===$.shape[2]||1===$.shape[2],(()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${$.shape[2]}.`)),x.hu("int32"===$.dtype||"float32"===$.dtype,(()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${$.dtype}.`)),x.hu("otsu"===t||"binary"===t,(()=>`Method must be binary or otsu, but was ${t}`)),3===$.shape[2]){[w,N,B]=(0,s.V)($,[1,1,1],-1);const n=(0,p.d)(w,.2989),t=(0,p.d)(N,.587),e=(0,p.d)(B,.114);S=(0,c.I)((0,c.I)(n,t),e)}else S=n;"otsu"===t&&(I=function(n,t){let e,o,a,s,i,u,m=(0,r.R)([-1]),v=(0,r.R)([0]),x=(0,r.R)([0]);for(let E=0;E<n.size-1;E++){e=(0,k.t)(n,0,E+1),o=(0,k.t)(n,E+1),i=(0,d.h)((0,l.S)(e),t),u=(0,d.h)((0,l.S)(o),t);const $=(0,l.S)((0,p.d)(e,(0,_.w)(0,e.size)));a=(0,d.h)($,(0,l.S)(e));const y=(0,b.h)(o.shape,e.size),w=(0,c.I)((0,_.w)(0,o.size),y),N=(0,p.d)(o,w);s=(0,d.h)((0,l.S)(N),(0,l.S)(o));const B=(0,f.l)(a,s),S=(0,f.l)(a,s),I=(0,p.d)(i,u);x=(0,p.d)((0,p.d)(I,B),S);const V=(0,h.p)(x,v);v=(0,g.a)(V,x,v),m=(0,g.a)(V,(0,r.R)([E]),m)}return m}((0,i.y)((0,a.p)((0,m.N)(S),"int32"),(0,v.X)([]),256),y));const V=e?(0,u.z)(S,I):(0,h.p)(S,I);return(0,a.p)((0,p.d)(V,255),"int32")}})},81034:(n,t,e)=>{e.d(t,{v:()=>i});var r=e(23926),o=e(29121),a=e(43740),s=e(20569);const i=(0,e(2668).op)({transform_:function(n,t,e="nearest",i="constant",u=0,h){const l=(0,a._1)(n,"image","transform","float32"),c=(0,a._1)(t,"transforms","transform","float32");s.hu(4===l.rank,(()=>`Error in transform: image must be rank 4,but got rank ${l.rank}.`)),s.hu(2===c.rank&&(c.shape[0]===l.shape[0]||1===c.shape[0])&&8===c.shape[1],(()=>"Error in transform: Input transform should be batch x 8 or 1 x 8")),s.hu(null==h||2===h.length,(()=>`Error in transform: outputShape must be [height, width] or null, but got ${h}.`));const p={image:l,transforms:c},d={interpolation:e,fillMode:i,fillValue:u,outputShape:h};return r.BV.runKernel(o.wx7,p,d)}})},92166:(n,t,e)=>{e.d(t,{V:()=>s});var r=e(43740),o=e(20569),a=e(10701);const s=async function(n,t,e=1){const s=(0,r._1)(n,"predictions","inTopK"),i=(0,r._1)(t,"targets","inTopK");(0,o.hu)(s.rank>1,(()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${s.rank}`)),(0,o.hu)(s.rank-1===i.rank,(()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${s.rank} and targets rank ${i.rank}`)),(0,o.k5)(s.shape.slice(0,s.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const u=s.shape[s.shape.length-1];(0,o.hu)(e>0&&e<=u,(()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${u}), but got ${e}`));const h=await s.data(),l=await i.data(),[c,p]=[h.length/u,u],d=(0,o.WP)("bool",c);for(let n=0;n<c;n++){const t=n*p,r=h.subarray(t,t+p),o=[];for(let n=0;n<r.length;n++)o.push({value:r[n],index:n});o.sort(((n,t)=>t.value-n.value)),d[n]=0;for(let t=0;t<e;t++)if(o[t].index===l[n]){d[n]=1;break}}return n!==s&&s.dispose(),t!==i&&i.dispose(),(0,a.X)(d,i.shape,"bool")}},13963:(n,t,e)=>{e.d(t,{x:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({isFinite_:function(n){const t={x:(0,a._1)(n,"x","isFinite")};return r.BV.runKernel(o.avt,t)}})},4365:(n,t,e)=>{e.d(t,{U:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({isInf_:function(n){const t={x:(0,a._1)(n,"x","isInf")};return r.BV.runKernel(o.iWB,t)}})},96230:(n,t,e)=>{e.d(t,{i:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({isNaN_:function(n){const t={x:(0,a._1)(n,"x","isNaN")};return r.BV.runKernel(o.r7n,t)}})},99133:(n,t,e)=>{e.d(t,{h:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({leakyRelu_:function(n,t=.2){const e={x:(0,a._1)(n,"x","leakyRelu")},s={alpha:t};return r.BV.runKernel(o.J$2,e,s)}})},86573:(n,t,e)=>{e.d(t,{d:()=>u});var r=e(23926),o=e(29121),a=e(80747),s=e(43740),i=e(72200);const u=(0,e(2668).op)({less_:function(n,t){let e=(0,s._1)(n,"a","less","string_or_numeric"),u=(0,s._1)(t,"b","less","string_or_numeric");[e,u]=(0,a.T_)(e,u),(0,i.assertAndGetBroadcastShape)(e.shape,u.shape);const h={a:e,b:u};return r.BV.runKernel(o.vtC,h)}})},50624:(n,t,e)=>{e.d(t,{z:()=>u});var r=e(23926),o=e(29121),a=e(80747),s=e(43740),i=e(72200);const u=(0,e(2668).op)({lessEqual_:function(n,t){let e=(0,s._1)(n,"a","lessEqual","string_or_numeric"),u=(0,s._1)(t,"b","lessEqual","string_or_numeric");[e,u]=(0,a.T_)(e,u),(0,i.assertAndGetBroadcastShape)(e.shape,u.shape);const h={a:e,b:u};return r.BV.runKernel(o.CAk,h)}})},601:(n,t,e)=>{e.d(t,{P:()=>b});var r=e(43740),o=e(20569),a=e(17630),s=e(50624),i=e(2856),u=e(2668),h=e(47245),l=e(4968),c=e(99494),p=e(82991),d=e(70827),f=e(24136),m=e(95912),g=e(59640);const b=(0,u.op)({bandPart_:function(n,t,e){(0,o.hu)(t%1==0,(()=>`bandPart(): numLower must be an integer, got ${t}.`)),(0,o.hu)(e%1==0,(()=>`bandPart(): numUpper must be an integer, got ${e}.`));const u=(0,r._1)(n,"a","bandPart");(0,o.hu)(u.rank>=2,(()=>`bandPart(): Rank must be at least 2, got ${u.rank}.`));const b=u.shape,[k,_]=u.shape.slice(-2);if(!(t<=k))throw new Error(`bandPart(): numLower (${t}) must not be greater than the number of rows (${k}).`);if(!(e<=_))throw new Error(`bandPart(): numUpper (${e}) must not be greater than the number of columns (${_}).`);t<0&&(t=k),e<0&&(e=_);const v=(0,l.X)((0,h.w)(0,k,1,"int32"),[-1,1]),x=(0,h.w)(0,_,1,"int32"),E=(0,d.l)(v,x),$=(0,i.H)((0,s.z)(E,(0,c.i)(+t,"int32")),(0,a.b)(E,(0,c.i)(-e,"int32"))),y=(0,g.l)([k,_],u.dtype);return(0,l.X)((0,p.k)((0,f.H)((0,l.X)(u,[-1,k,_])).map((n=>(0,m.a)($,n,y)))),b)}})},25453:(n,t,e)=>{e.d(t,{G:()=>f});var r=e(23926),o=e(20569),a=e(41274),s=e(24841),i=e(3561),u=e(2668),h=e(28644),l=e(79590),c=e(82991),p=e(70827),d=e(15475);const f=(0,u.op)({gramSchmidt_:function(n){let t;if(Array.isArray(n)){t=!1,(0,o.hu)(null!=n&&n.length>0,(()=>"Gram-Schmidt process: input must not be null, undefined, or empty"));const e=n[0].shape[0];for(let t=1;t<n.length;++t)(0,o.hu)(n[t].shape[0]===e,(()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${n[t].shape[0]} vs. ${e})`))}else t=!0,n=(0,h.V)(n,n.shape[0],0).map((n=>(0,l.L)(n,[0])));(0,o.hu)(n.length<=n[0].shape[0],(()=>`Gram-Schmidt: Number of vectors (${n.length}) exceeds number of dimensions (${n[0].shape[0]}).`));const e=[],u=n;for(let t=0;t<n.length;++t)e.push(r.BV.tidy((()=>{let n=u[t];if(t>0)for(let r=0;r<t;++r){const t=(0,s.d)((0,d.S)((0,s.d)(e[r],n)),e[r]);n=(0,p.l)(n,t)}return(0,a.h)(n,(0,i.K)(n,"euclidean"))})));return t?(0,c.k)(e,0):e}})},32512:(n,t,e)=>{e.d(t,{qr:()=>w});var r=e(23926),o=e(4368),a=e(20569),s=e(8723),i=e(46884),u=e(41274),h=e(66557),l=e(20636),c=e(28687),p=e(24841),d=e(17370),f=e(3561),m=e(2668),g=e(4968),b=e(22676),k=e(82991),_=e(70827),v=e(24376),x=e(89065),E=e(24136),$=e(95912);function y(n,t=!1){return r.BV.tidy((()=>{(0,a.hu)(2===n.shape.length,(()=>`qr2d() requires a 2D Tensor, but got a ${n.shape.length}D Tensor.`));const e=n.shape[0],m=n.shape[1];let g=(0,h.i)(e),k=(0,s.d)(n);const E=(0,v.o)([[1]],[1,1]);let y=(0,s.d)(E);const w=e>=m?m:e;for(let n=0;n<w;++n){const t=k,a=y,h=g;[y,k,g]=r.BV.tidy((()=>{const t=(0,b.t)(k,[n,n],[e-n,1]),r=(0,f.K)(t),o=(0,b.t)(k,[n,n],[1,1]),a=(0,$.a)((0,l.p)(o,0),(0,v.o)([[-1]]),(0,v.o)([[1]])),h=(0,_.l)(o,(0,p.d)(a,r)),w=(0,u.h)(t,h);y=1===w.shape[0]?(0,s.d)(E):(0,i.z)([E,(0,b.t)(w,[1,0],[w.shape[0]-1,w.shape[1]])],0);const N=(0,d.W)((0,u.h)((0,c.O)(a,h),r)),B=(0,b.t)(k,[n,0],[e-n,m]),S=(0,p.d)(N,y),I=(0,x.p)(y);if(0===n)k=(0,_.l)(B,(0,c.O)(S,(0,c.O)(I,B)));else{const t=(0,_.l)(B,(0,c.O)(S,(0,c.O)(I,B)));k=(0,i.z)([(0,b.t)(k,[0,0],[n,m]),t],0)}const V=(0,x.p)(S),D=(0,b.t)(g,[0,n],[e,g.shape[1]-n]);if(0===n)g=(0,_.l)(D,(0,c.O)((0,c.O)(D,y),V));else{const t=(0,_.l)(D,(0,c.O)((0,c.O)(D,y),V));g=(0,i.z)([(0,b.t)(g,[0,0],[e,n]),t],1)}return[y,k,g]})),(0,o.B9)([t,a,h])}return!t&&e>m&&(g=(0,b.t)(g,[0,0],[e,m]),k=(0,b.t)(k,[0,0],[m,m])),[g,k]}))}const w=(0,m.op)({qr_:function(n,t=!1){if((0,a.hu)(n.rank>=2,(()=>`qr() requires input tensor to have a rank >= 2, but got rank ${n.rank}`)),2===n.rank)return y(n,t);{const e=n.shape.slice(0,n.shape.length-2).reduce(((n,t)=>n*t)),r=(0,E.H)((0,g.X)(n,[e,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),o=[],a=[];return r.forEach((n=>{const[e,r]=y(n,t);o.push(e),a.push(r)})),[(0,g.X)((0,k.k)(o,0),n.shape),(0,g.X)((0,k.k)(a,0),n.shape)]}}})},14135:(n,t,e)=>{e.d(t,{S:()=>a});var r=e(23926),o=e(29121);function a(n,t,e){if(e<=0)throw new Error("The number of values should be positive.");const a={start:n,stop:t,num:e};return r.BV.runKernel(o.e7N,{},a)}},79648:(n,t,e)=>{e.d(t,{G:()=>h});var r=e(23926),o=e(29121),a=e(43740),s=e(20569),i=e(2668),u=e(4968);const h=(0,i.op)({localResponseNormalization_:function(n,t=5,e=1,i=1,h=.5){const l=(0,a._1)(n,"x","localResponseNormalization");s.hu(4===l.rank||3===l.rank,(()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ${l.rank}.`)),s.hu(s.GN(t),(()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`));let c=l,p=!1;3===l.rank&&(p=!0,c=(0,u.X)(l,[1,l.shape[0],l.shape[1],l.shape[2]]));const d={x:c},f={depthRadius:t,bias:e,alpha:i,beta:h},m=r.BV.runKernel(o.eZ0,d,f);return p?(0,u.X)(m,[m.shape[1],m.shape[2],m.shape[3]]):m}})},69369:(n,t,e)=>{e.d(t,{Y:()=>a});var r=e(23926),o=e(29121);const a=(0,e(2668).op)({localResponseNormalizationBackprop_:function(n,t,e,a=5,s=1,i=1,u=.5){const h={x:n,y:t,dy:e},l={depthRadius:a,bias:s,alpha:i,beta:u};return r.BV.runKernel(o.Hhh,h,l)}})},82597:(n,t,e)=>{e.d(t,{c:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({log_:function(n){const t={x:(0,a._1)(n,"x","log","float32")};return r.BV.runKernel(o.ZbH,t)}})},17474:(n,t,e)=>{e.d(t,{K:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({log1p_:function(n){const t={x:(0,a._1)(n,"x","log1p")};return r.BV.runKernel(o.kU,t)}})},13888:(n,t,e)=>{e.d(t,{e:()=>l});var r=e(30633),o=e(43740),a=e(24841),s=e(17370),i=e(2668),u=e(30625),h=e(3694);const l=(0,i.op)({logSigmoid_:function(n){const t=(0,o._1)(n,"x","logSigmoid");return(0,r.cb)((n=>({value:(0,s.W)((0,h.W)((0,s.W)(n))),gradFunc:t=>(0,a.d)(t,(0,u.X)((0,s.W)(n)))})))(t)}})},31510:(n,t,e)=>{e.d(t,{C:()=>d});var r=e(30633),o=e(43740),a=e(62271),s=e(44842),i=e(82597),u=e(83307),h=e(24841),l=e(2668),c=e(70827),p=e(15475);const d=(0,l.op)({logSoftmax_:function(n,t=-1){const e=(0,o._1)(n,"logits","logSoftmax");if(-1===t&&(t=e.rank-1),t!==e.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${e.rank} and axis was ${t}`);return(0,r.cb)(((n,e)=>{const r=(0,u.F)(n,t,!0),o=(0,c.l)(n,r),l=(0,c.l)((0,a.p)(o,"float32"),(0,i.c)((0,p.S)((0,s.Q)(o),t,!0)));return e([l]),{value:l,gradFunc:(n,e)=>{const[r]=e,o=(0,s.Q)(r);return(0,c.l)(n,(0,h.d)((0,p.S)(n,t,!0),o))}}}))(e)}})},11391:(n,t,e)=>{e.d(t,{l:()=>f});var r=e(43740),o=e(20569),a=e(56407),s=e(83591),i=e(44842),u=e(82597),h=e(83307),l=e(2668),c=e(4968),p=e(70827),d=e(15475);const f=(0,l.op)({logSumExp_:function(n,t=null,e=!1){const l=(0,r._1)(n,"x","logSumExp"),f=(0,o.EC)(t,l.shape),m=(0,h.F)(l,f,!0),g=(0,p.l)(l,m),b=(0,i.Q)(g),k=(0,d.S)(b,f),_=(0,u.c)(k),v=(0,a.I)((0,c.X)(m,_.shape),_);if(e){const n=(0,s.rv)(v.shape,f);return(0,c.X)(v,n)}return v}})},2856:(n,t,e)=>{e.d(t,{H:()=>i});var r=e(23926),o=e(29121),a=e(43740),s=e(72200);const i=(0,e(2668).op)({logicalAnd_:function(n,t){const e=(0,a._1)(n,"a","logicalAnd","bool"),i=(0,a._1)(t,"b","logicalAnd","bool");(0,s.assertAndGetBroadcastShape)(e.shape,i.shape);const u={a:e,b:i};return r.BV.runKernel(o.PYm,u)}})},38651:(n,t,e)=>{e.d(t,{h:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({logicalNot_:function(n){const t={x:(0,a._1)(n,"x","logicalNot","bool")};return r.BV.runKernel(o.VfG,t)}})},15750:(n,t,e)=>{e.d(t,{K:()=>i});var r=e(23926),o=e(29121),a=e(43740),s=e(72200);const i=(0,e(2668).op)({logicalOr_:function(n,t){const e=(0,a._1)(n,"a","logicalOr","bool"),i=(0,a._1)(t,"b","logicalOr","bool");(0,s.assertAndGetBroadcastShape)(e.shape,i.shape);const u={a:e,b:i};return r.BV.runKernel(o.MZg,u)}})},10596:(n,t,e)=>{e.d(t,{e:()=>u});var r=e(43740),o=e(72200),a=e(2856),s=e(38651),i=e(15750);const u=(0,e(2668).op)({logicalXor_:function(n,t){const e=(0,r._1)(n,"a","logicalXor","bool"),u=(0,r._1)(t,"b","logicalXor","bool");return(0,o.assertAndGetBroadcastShape)(e.shape,u.shape),(0,a.H)((0,i.K)(n,t),(0,s.h)((0,a.H)(n,t)))}})},49876:(n,t,e)=>{var r;e.d(t,{I:()=>r}),function(n){n[n.NONE=0]="NONE",n[n.MEAN=1]="MEAN",n[n.SUM=2]="SUM",n[n.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(r||(r={}))},41326:(n,t,e)=>{e.d(t,{O:()=>l});var r=e(43740),o=e(20569),a=e(96235),s=e(49876),i=e(2668),u=e(70827),h=e(36142);const l=(0,i.op)({absoluteDifference_:function(n,t,e,i=s.I.SUM_BY_NONZERO_WEIGHTS){const l=(0,r._1)(n,"labels","absoluteDifference"),c=(0,r._1)(t,"predictions","absoluteDifference");let p=null;null!=e&&(p=(0,r._1)(e,"weights","absoluteDifference")),(0,o.k5)(l.shape,c.shape,"Error in absoluteDifference: ");const d=(0,a.W)((0,u.l)(l,c));return(0,h.m)(d,p,i)}})},36142:(n,t,e)=>{e.d(t,{m:()=>f});var r=e(43740),o=e(62271),a=e(41274),s=e(49876),i=e(75130),u=e(24841),h=e(16500),l=e(44917),c=e(2668),p=e(99494),d=e(15475);const f=(0,c.op)({computeWeightedLoss_:function(n,t,e=s.I.SUM_BY_NONZERO_WEIGHTS){const c=(0,r._1)(n,"losses","computeWeightedLoss");let f=null;null!=t&&(f=(0,r._1)(t,"weights","computeWeightedLoss"));const m=null==f?c:(0,u.d)(c,f);if(e===s.I.NONE)return m;if(e===s.I.SUM)return(0,d.S)(m);if(e===s.I.MEAN){if(null==f)return(0,i.J)(m);{const n=c.size/f.size,t=(0,a.h)((0,d.S)(m),(0,d.S)(f));return n>1?(0,a.h)(t,(0,p.i)(n)):t}}if(e===s.I.SUM_BY_NONZERO_WEIGHTS){if(null==f)return(0,a.h)((0,d.S)(m),(0,p.i)(c.size));{const n=(0,u.d)(f,(0,l.i)(c.shape)),t=(0,o.p)((0,d.S)((0,h.Q)(n,(0,p.i)(0))),"float32");return(0,a.h)((0,d.S)(m),t)}}throw Error(`Unknown reduction: ${e}`)}})},77789:(n,t,e)=>{e.d(t,{Z:()=>p});var r=e(43740),o=e(20569),a=e(49876),s=e(24841),i=e(2668),u=e(99494),h=e(70827),l=e(15475),c=e(36142);const p=(0,i.op)({cosineDistance_:function(n,t,e,i,p=a.I.SUM_BY_NONZERO_WEIGHTS){const d=(0,r._1)(n,"labels","cosineDistance"),f=(0,r._1)(t,"predictions","cosineDistance");let m=null;null!=i&&(m=(0,r._1)(i,"weights","cosineDistance")),(0,o.k5)(d.shape,f.shape,"Error in cosineDistance: ");const g=(0,u.i)(1),b=(0,h.l)(g,(0,l.S)((0,s.d)(d,f),e,!0));return(0,c.m)(b,m,p)}})},29599:(n,t,e)=>{e.d(t,{O:()=>p});var r=e(43740),o=e(20569),a=e(49876),s=e(24841),i=e(2668),u=e(7409),h=e(99494),l=e(70827),c=e(36142);const p=(0,i.op)({hingeLoss_:function(n,t,e,i=a.I.SUM_BY_NONZERO_WEIGHTS){let p=(0,r._1)(n,"labels","hingeLoss");const d=(0,r._1)(t,"predictions","hingeLoss");let f=null;null!=e&&(f=(0,r._1)(e,"weights","hingeLoss")),(0,o.k5)(p.shape,d.shape,"Error in hingeLoss: ");const m=(0,h.i)(1);p=(0,l.l)((0,s.d)((0,h.i)(2),p),m);const g=(0,u.U)((0,l.l)(m,(0,s.d)(p,d)));return(0,c.m)(g,f,i)}})},95317:(n,t,e)=>{e.d(t,{H:()=>m});var r=e(43740),o=e(20569),a=e(96235),s=e(56407),i=e(49876),u=e(24513),h=e(24841),l=e(2668),c=e(99494),p=e(50248),d=e(70827),f=e(36142);const m=(0,l.op)({huberLoss_:function(n,t,e,l=1,m=i.I.SUM_BY_NONZERO_WEIGHTS){const g=(0,r._1)(n,"labels","huberLoss"),b=(0,r._1)(t,"predictions","huberLoss");let k=null;null!=e&&(k=(0,r._1)(e,"weights","huberLoss")),(0,o.k5)(g.shape,b.shape,"Error in huberLoss: ");const _=(0,c.i)(l),v=(0,a.W)((0,d.l)(b,g)),x=(0,u.L)(v,_),E=(0,d.l)(v,x),$=(0,s.I)((0,h.d)((0,c.i)(.5),(0,p.h)(x)),(0,h.d)(_,E));return(0,f.m)($,k,m)}})},4824:(n,t,e)=>{e.d(t,{g:()=>f});var r=e(43740),o=e(20569),a=e(56407),s=e(82597),i=e(49876),u=e(24841),h=e(17370),l=e(2668),c=e(99494),p=e(70827),d=e(36142);const f=(0,l.op)({logLoss_:function(n,t,e,l=1e-7,f=i.I.SUM_BY_NONZERO_WEIGHTS){const m=(0,r._1)(n,"labels","logLoss"),g=(0,r._1)(t,"predictions","logLoss");let b=null;null!=e&&(b=(0,r._1)(e,"weights","logLoss")),(0,o.k5)(m.shape,g.shape,"Error in logLoss: ");const k=(0,c.i)(1),_=(0,c.i)(l),v=(0,h.W)((0,u.d)(m,(0,s.c)((0,a.I)(g,_)))),x=(0,u.d)((0,p.l)(k,m),(0,s.c)((0,a.I)((0,p.l)(k,g),_))),E=(0,p.l)(v,x);return(0,d.m)(E,b,f)}})},42695:(n,t,e)=>{e.d(t,{F:()=>h});var r=e(43740),o=e(20569),a=e(49876),s=e(2668),i=e(15265),u=e(36142);const h=(0,s.op)({meanSquaredError_:function(n,t,e,s=a.I.SUM_BY_NONZERO_WEIGHTS){const h=(0,r._1)(n,"labels","meanSquaredError"),l=(0,r._1)(t,"predictions","meanSquaredError");let c=null;null!=e&&(c=(0,r._1)(e,"weights","meanSquaredError")),(0,o.k5)(h.shape,l.shape,"Error in meanSquaredError: ");const p=(0,i.$)(h,l);return(0,u.m)(p,c,s)}})},75706:(n,t,e)=>{e.d(t,{f:()=>b});var r=e(43740),o=e(20569),a=e(96235),s=e(56407),i=e(44842),u=e(17474),h=e(49876),l=e(24841),c=e(17370),p=e(2668),d=e(7409),f=e(99494),m=e(70827),g=e(36142);const b=(0,p.op)({sigmoidCrossEntropy_:function(n,t,e,p=0,b=h.I.SUM_BY_NONZERO_WEIGHTS){let k=(0,r._1)(n,"multiClassLabels","sigmoidCrossEntropy");const _=(0,r._1)(t,"logits","sigmoidCrossEntropy");let v=null;if(null!=e&&(v=(0,r._1)(e,"weights","sigmoidCrossEntropy")),(0,o.k5)(k.shape,_.shape,"Error in sigmoidCrossEntropy: "),p>0){const n=(0,f.i)(p),t=(0,f.i)(1),e=(0,f.i)(.5);k=(0,s.I)((0,l.d)(k,(0,m.l)(t,n)),(0,l.d)(e,n))}const x=function(n,t){const e=(0,r._1)(n,"labels","sigmoidCrossEntropyWithLogits"),h=(0,r._1)(t,"logits","sigmoidCrossEntropyWithLogits");(0,o.k5)(e.shape,h.shape,"Error in sigmoidCrossEntropyWithLogits: ");const p=(0,d.U)(h),f=(0,l.d)(h,e),g=(0,u.K)((0,i.Q)((0,c.W)((0,a.W)(h))));return(0,s.I)((0,m.l)(p,f),g)}(k,_);return(0,g.m)(x,v,b)}})},67740:(n,t,e)=>{e.d(t,{E:()=>x});var r=e(30633),o=e(43740),a=e(20569),s=e(56407),i=e(83591),u=e(62271),h=e(41274),l=e(44842),c=e(11391),p=e(49876),d=e(24841),f=e(17370),m=e(2668),g=e(4968),b=e(99494),k=e(70827),_=e(15475),v=e(36142);const x=(0,m.op)({softmaxCrossEntropy_:function(n,t,e,m=0,x=p.I.SUM_BY_NONZERO_WEIGHTS){let E=(0,o._1)(n,"onehotLabels","softmaxCrossEntropy");const $=(0,o._1)(t,"logits","softmaxCrossEntropy");let y=null;if(null!=e&&(y=(0,o._1)(e,"weights","softmaxCrossEntropy")),(0,a.k5)(E.shape,$.shape,"Error in softmaxCrossEntropy: "),m>0){const n=(0,b.i)(m),t=(0,b.i)(1),e=(0,b.i)(E.shape[1]);E=(0,s.I)((0,d.d)(E,(0,k.l)(t,n)),(0,h.h)(n,e))}const w=function(n,t,e=-1){if(-1===e&&(e=t.rank-1),e!==t.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${t.rank} and dim was ${e}`);const o=(0,r.cb)(((n,t,r)=>{const o=(0,c.l)(t,[e],!0),a=(0,k.l)((0,u.p)(t,"float32"),o);r([n,a]);const s=(0,f.W)((0,d.d)(a,n));return{value:(0,_.S)(s,[e]),gradFunc:(n,t)=>{const[r,o]=t,a=(0,i.rv)(n.shape,[e]);return[(0,d.d)((0,g.X)(n,a),(0,k.l)((0,u.p)(r,"float32"),(0,l.Q)(o))),(0,d.d)((0,g.X)(n,a),(0,k.l)((0,l.Q)(o),(0,u.p)(r,"float32")))]}}}));return o(n,t)}(E,$);return(0,v.m)(w,y,x)}})},94608:(n,t,e)=>{e.d(t,{e:()=>o});var r=e(43336);function o(n,t){return(0,r.z)(n,t,"left")}},28687:(n,t,e)=>{e.d(t,{O:()=>i});var r=e(23926),o=e(29121),a=e(80747),s=e(43740);const i=(0,e(2668).op)({matMul_:function(n,t,e=!1,i=!1){let u=(0,s._1)(n,"a","matMul"),h=(0,s._1)(t,"b","matMul");[u,h]=(0,a.T_)(u,h);const l={a:u,b:h},c={transposeA:e,transposeB:i};return r.BV.runKernel(o.XLW,l,c)}})},83307:(n,t,e)=>{e.d(t,{F:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({max_:function(n,t=null,e=!1){const s={x:(0,a._1)(n,"x","max")},i={reductionIndices:t,keepDims:e};return r.BV.runKernel(o.YoZ,s,i)}})},21174:(n,t,e)=>{e.d(t,{_:()=>l});var r=e(23926),o=e(29121),a=e(43740),s=e(20569),i=e(2582),u=e(2668),h=e(4968);const l=(0,u.op)({maxPool_:function(n,t,e,u,l){const c=(0,a._1)(n,"x","maxPool");let p=c,d=!1;3===c.rank&&(d=!0,p=(0,h.X)(c,[1,c.shape[0],c.shape[1],c.shape[2]])),s.hu(4===p.rank,(()=>`Error in maxPool: input must be rank 4 but got rank ${p.rank}.`)),s.hu(i.jT(e,1),(()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${e} and dilations '1'`)),i.m("maxPool",u,l);const f={x:p},m={filterSize:t,strides:e,pad:u,dimRoundingMode:l},g=r.BV.runKernel(o.mTV,f,m);return d?(0,h.X)(g,[g.shape[1],g.shape[2],g.shape[3]]):g}})},25020:(n,t,e)=>{e.d(t,{Y:()=>l});var r=e(23926),o=e(29121),a=e(43740),s=e(20569),i=e(2582),u=e(2668),h=e(4968);const l=(0,u.op)({maxPool3d_:function(n,t=[1,1,1],e,u,l,c="NDHWC"){const p=(0,a._1)(n,"x","maxPool3d");let d=p,f=!1;4===p.rank&&(f=!0,d=(0,h.X)(p,[1,p.shape[0],p.shape[1],p.shape[2],p.shape[3]])),s.hu(5===d.rank,(()=>`Error in maxPool3d: x must be rank 5 but got rank ${d.rank}.`)),s.hu("NDHWC"===c,(()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${c}`)),(0,i.m)("maxPool3d",u,l);const m={x:d},g={filterSize:t,strides:e,pad:u,dimRoundingMode:l,dataFormat:c},b=r.BV.runKernel(o.OAf,m,g);return f?(0,h.X)(b,[b.shape[1],b.shape[2],b.shape[3],b.shape[4]]):b}})},35080:(n,t,e)=>{e.d(t,{x:()=>l});var r=e(23926),o=e(29121),a=e(43740),s=e(20569),i=e(2582),u=e(2668),h=e(4968);const l=(0,u.op)({maxPool3dGrad_:function(n,t,e,u,l,c,p){const d=(0,a._1)(n,"dy","maxPool3dGrad"),f=(0,a._1)(t,"input","maxPool3dGrad"),m=(0,a._1)(e,"output","maxPool3dGrad");let g=d,b=f,k=m,_=!1;4===f.rank&&(_=!0,g=(0,h.X)(d,[1,d.shape[0],d.shape[1],d.shape[2],d.shape[3]]),b=(0,h.X)(f,[1,f.shape[0],f.shape[1],f.shape[2],f.shape[3]]),k=(0,h.X)(m,[1,m.shape[0],m.shape[1],m.shape[2],m.shape[3]])),s.hu(5===g.rank,(()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${g.rank}.`)),s.hu(5===b.rank,(()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${b.rank}.`)),s.hu(5===k.rank,(()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${k.rank}.`)),(0,i.m)("maxPool3dGrad",c,p);const v={dy:g,input:b,output:k},x={filterSize:u,strides:l,pad:c,dimRoundingMode:p},E=r.BV.runKernel(o.OU7,v,x);return _?(0,h.X)(E,[E.shape[1],E.shape[2],E.shape[3],E.shape[4]]):E}})},71708:(n,t,e)=>{e.d(t,{z:()=>u});var r=e(23926),o=e(29121),a=e(43740),s=e(20569),i=e(2582);const u=(0,e(2668).op)({maxPoolGrad_:function(n,t,e,u,h,l,c){const p=(0,a._1)(n,"dy","maxPoolGrad"),d=(0,a._1)(t,"input","maxPoolGrad"),f=(0,a._1)(e,"output","maxPoolGrad");s.hu(d.rank===p.rank,(()=>`Rank of input (${d.rank}) does not match rank of dy (${p.rank})`)),s.hu(4===p.rank,(()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${p.rank}.`)),s.hu(4===d.rank,(()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${d.rank}.`)),i.m("maxPoolGrad",l,c);const m={dy:p,input:d,output:f},g={filterSize:u,strides:h,pad:l,dimRoundingMode:c};return r.BV.runKernel(o.OV7,m,g)}})},96877:(n,t,e)=>{e.d(t,{I:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({maxPoolWithArgmax_:function(n,t,e,s,i=!1){const u={x:(0,a._1)(n,"x","maxPoolWithArgmax")},h={filterSize:t,strides:e,pad:s,includeBatchInIndex:i},l=r.BV.runKernel(o.vFR,u,h);return{result:l[0],indexes:l[1]}}})},80632:(n,t,e)=>{e.d(t,{g:()=>h});var r=e(23926),o=e(29121),a=e(80747),s=e(43740),i=e(72200),u=e(62271);const h=(0,e(2668).op)({maximum_:function(n,t){let e=(0,s._1)(n,"a","maximum"),h=(0,s._1)(t,"b","maximum");[e,h]=(0,a.T_)(e,h),"bool"===e.dtype&&(e=(0,u.p)(e,"int32"),h=(0,u.p)(h,"int32")),(0,i.assertAndGetBroadcastShape)(e.shape,h.shape);const l={a:e,b:h};return r.BV.runKernel(o.BMI,l)}})},75130:(n,t,e)=>{e.d(t,{J:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({mean_:function(n,t=null,e=!1){const s={x:(0,a._1)(n,"x","mean")},i={axis:t,keepDims:e};return r.BV.runKernel(o.q2K,s,i)}})},82541:(n,t,e)=>{e.d(t,{r:()=>h});var r=e(28687),o=e(44917),a=e(4968),s=e(4077),i=e(43740),u=e(20569);function h(n,t,{indexing:e="xy"}={}){if("xy"!==e&&"ij"!==e)throw new TypeError(`${e} is not a valid third argument to meshgrid`);if(void 0===n)return[];let h=(0,i._1)(n,"x","meshgrid",n instanceof s.es?n.dtype:"float32");if(void 0===t)return[h];let l=(0,i._1)(t,"y","meshgrid",t instanceof s.es?t.dtype:"float32");const c=(0,u.NA)(h.shape),p=(0,u.NA)(l.shape);return"xy"===e?(h=(0,a.X)(h,[1,-1]),l=(0,a.X)(l,[-1,1]),[(0,r.O)((0,o.i)([p,1],h.dtype),h),(0,r.O)(l,(0,o.i)([1,c],l.dtype))]):(h=(0,a.X)(h,[-1,1]),l=(0,a.X)(l,[1,-1]),[(0,r.O)(h,(0,o.i)([1,p],h.dtype)),(0,r.O)((0,o.i)([c,1],l.dtype),l)])}},25735:(n,t,e)=>{e.d(t,{V:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({min_:function(n,t=null,e=!1){const s={x:(0,a._1)(n,"x","min")},i={axis:t,keepDims:e};return r.BV.runKernel(o.c17,s,i)}})},24513:(n,t,e)=>{e.d(t,{L:()=>h});var r=e(23926),o=e(29121),a=e(80747),s=e(43740),i=e(72200),u=e(62271);const h=(0,e(2668).op)({minimum_:function(n,t){let e=(0,s._1)(n,"a","minimum"),h=(0,s._1)(t,"b","minimum");[e,h]=(0,a.T_)(e,h),"bool"===e.dtype&&(e=(0,u.p)(e,"int32"),h=(0,u.p)(h,"int32")),(0,i.assertAndGetBroadcastShape)(e.shape,h.shape);const l={a:e,b:h};return r.BV.runKernel(o.q8u,l)}})},71483:(n,t,e)=>{e.d(t,{V:()=>i});var r=e(23926),o=e(29121),a=e(43740),s=e(20569);const i=(0,e(2668).op)({mirrorPad_:function(n,t,e){s.hu("reflect"===e||"symmetric"===e,(()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${e}.`));const i=(0,a._1)(n,"x","mirrorPad");if(0===i.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");s.hu(t.length===i.rank,(()=>`Padding doesn't match input. Must be ${i.rank}. Got ${t.length}.`));const u="reflect"===e?1:0;for(let n=0;n<i.rank;n++)s.hu(2===t[n].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),s.hu(t[n][0]>=0&&t[n][0]<=i.shape[n]-u&&t[n][1]>=0&&t[n][1]<=i.shape[n]-u,(()=>`Padding in dimension ${n} cannot be greater than or equal to ${i.shape[n]-u} or less than 0 for input of shape ${i.shape}`));const h={paddings:t,mode:e},l={x:i};return r.BV.runKernel(o.jQs,l,h)}})},85228:(n,t,e)=>{e.d(t,{w:()=>i});var r=e(23926),o=e(29121),a=e(80747),s=e(43740);const i=(0,e(2668).op)({mod_:function(n,t){let e=(0,s._1)(n,"a","mod"),i=(0,s._1)(t,"b","mod");[e,i]=(0,a.T_)(e,i);const u={a:e,b:i};return r.BV.runKernel(o.Vbg,u)}})},73276:(n,t,e)=>{e.d(t,{G:()=>p});var r=e(43740),o=e(20569),a=e(83591),s=e(62271),i=e(75130),u=e(2668),h=e(4968),l=e(50248),c=e(70827);const p=(0,u.op)({moments_:function(n,t=null,e=!1){n=(0,r._1)(n,"x","moments");const u=(0,o.EC)(t,n.shape),p=(0,i.J)(n,u,e);let d=p.shape;e||(d=(0,a.rv)(p.shape,u));const f=(0,l.h)((0,c.l)((0,s.p)(n,"float32"),(0,h.X)(p,d)));return{mean:p,variance:(0,i.J)(f,u,e)}}})},96476:(n,t,e)=>{e.d(t,{p:()=>d});var r=e(80747),o=e(43740),a=e(20569),s=e(56407),i=e(41274),u=e(24841),h=e(2668),l=e(33453),c=e(99494),p=e(70827);const d=(0,h.op)({movingAverage_:function(n,t,e,h,d=!0){const f=(0,o._1)(n,"v","movingAverage"),m=(0,o._1)(t,"x","movingAverage"),g=(0,o._1)(e,"decay","movingAverage");(0,r.xg)(f,m),a.hu(a.cO(f.shape,m.shape),(()=>"Shape mismatch in v and x"));const b=(0,c.i)(1),k=(0,p.l)(b,g);let _=(0,u.d)((0,p.l)(m,f),k);if(d){a.hu(null!=h,(()=>"When using zeroDebias: true, step is required."));const n=(0,o._1)(h,"step","movingAverage");_=(0,i.h)(_,(0,p.l)(b,(0,l.s)(g,n)))}return(0,s.I)(f,_)}})},24841:(n,t,e)=>{e.d(t,{d:()=>i});var r=e(23926),o=e(29121),a=e(80747),s=e(43740);const i=(0,e(2668).op)({mul_:function(n,t){let e=(0,s._1)(n,"a","mul"),i=(0,s._1)(t,"b","mul");[e,i]=(0,a.T_)(e,i);const u={a:e,b:i};return r.BV.runKernel(o.wYn,u)}})},78656:(n,t,e)=>{e.d(t,{r:()=>o});var r=e(43740);const o=(0,e(2668).op)({multiRNNCell_:function(n,t,e,o){const a=(0,r._1)(t,"data","multiRNNCell"),s=(0,r.sI)(e,"c","multiRNNCell"),i=(0,r.sI)(o,"h","multiRNNCell");let u=a;const h=[];for(let t=0;t<n.length;t++){const e=n[t](u,s[t],i[t]);h.push(e[0]),h.push(e[1]),u=e[1]}const l=[],c=[];for(let n=0;n<h.length;n+=2)l.push(h[n]),c.push(h[n+1]);return[l,c]}})},90686:(n,t,e)=>{e.d(t,{S:()=>u});var r=e(23926),o=e(29121),a=e(43740),s=e(2668),i=e(4968);const u=(0,s.op)({multinomial_:function(n,t,e,s=!1){const u=(0,a._1)(n,"logits","multinomial"),h=u.size,l=u.rank;if(h<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${h}.`);if(l>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${l}`);e=e||Math.random();const c={logits:1===l?(0,i.X)(u,[1,-1]):u},p={numSamples:t,seed:e,normalized:s},d=r.BV.runKernel(o.NZg,c,p);return 1===l?(0,i.X)(d,[d.size]):d}})},17370:(n,t,e)=>{e.d(t,{W:()=>s});var r=e(23926),o=e(29121),a=e(43740);const s=(0,e(2668).op)({neg_:function(n){const t={x:(0,a._1)(n,"x","neg")};return r.BV.runKernel(o.kuV,t)}})}}]);